const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./adapter.idb-CmHDc2SO.js","./many-CvjudpRv.js"])))=>i.map(i=>d[i]);
import{g as dn,s as gn,r as wn}from"./many-CvjudpRv.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();const Ye={BASE_URL:"https://eco-taxi.one",BOARD:3934194107,ADMIN_KEY:"028f6245d765045c4a8cfe3b44d5e3b4d3dc1d969e4d4d19220b56ac3f77ce19bf",MAIN_KEY:"eyJhbGciOiJIUzI1NiJ9.eyJ0aWQiOjIzNjE2NzQ4MCwidWlkIjozODY2OTA2NCwiaWFkIjoiMjAyMy0wMi0xMFQxMjoxNjowOS43NzRaIiwicGVyIjoibWU6d3JpdGUiLCJhY3RpZCI6MTA1OTI2MTUsInJnbiI6InVzZTEifQ.oNz6k1Glu1YMbLwRHwYnVsQiOBcsMgzTWDwDJJgkSLY"},mn="modulepreload",bn=function(t,e){return new URL(t,e).href},Zt={},vn=function(e,n,o){let a=Promise.resolve();if(n&&n.length>0){const u=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),h=s?.nonce||s?.getAttribute("nonce");a=Promise.allSettled(n.map(g=>{if(g=bn(g,o),g in Zt)return;Zt[g]=!0;const y=g.endsWith(".css"),d=y?'[rel="stylesheet"]':"";if(!!o)for(let E=u.length-1;E>=0;E--){const B=u[E];if(B.href===g&&(!y||B.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${g}"]${d}`))return;const w=document.createElement("link");if(w.rel=y?"stylesheet":mn,y||(w.as="script"),w.crossOrigin="",w.href=g,h&&w.setAttribute("nonce",h),document.head.appendChild(w),y)return new Promise((E,B)=>{w.addEventListener("load",E),w.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${g}`)))})}))}function l(u){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=u,window.dispatchEvent(s),!s.defaultPrevented)throw u}return a.then(u=>{for(const s of u||[])s.status==="rejected"&&l(s.reason);return e().catch(l)})};/*! WebAuthn-Local-Client: bundlers/walc.mjs
    v0.2000.1 (c) 2025 Kyle Simpson
    MIT License: http://getify.mit-license.org
*/const br=[{name:"Ed25519",COSEID:-8,cipherOpts:{name:"Ed25519",hash:{name:"SHA-512"}}},{name:"ES256",COSEID:-7,cipherOpts:{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}}},{name:"RSASSA-PSS",COSEID:-37,cipherOpts:{name:"RSA-PSS",hash:{name:"SHA-256"}}},{name:"RS256",COSEID:-257,cipherOpts:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}}}],Ze=Object.fromEntries(br.flatMap(t=>[[t.name,t],[t.COSEID,t]])),Q=Symbol("credential-type"),vr=Symbol("reset-abort"),Ut=typeof navigator<"u"&&navigator.credentials!==void 0&&navigator.credentials.create!==void 0&&navigator.credentials.get!==void 0;Ut&&PublicKeyCredential.isConditionalMediationAvailable!==void 0&&await PublicKeyCredential.isConditionalMediationAvailable();async function En(t=Er()){try{if(Ut){t[t[Q]].excludeCredentials=Sr(t[t[Q]].excludeCredentials);let e=await navigator.credentials.create(t),n=new Uint8Array(e.response.clientDataJSON),o=JSON.parse(Dt(n));if(o.type!="webauthn.create")throw new Error("Invalid registration response");let a=sodium.to_base64(t[t[Q]].challenge,sodium.base64_variants.URLSAFE_NO_PADDING);if(o.challenge!=a)throw new Error("Challenge not accepted");let l=e.response.getPublicKeyAlgorithm(),u=new Uint8Array(e.response.getPublicKey()),{algo:s,raw:h}=function(d){var v=ASN1.parseVerbose(d);return{algo:sodium.to_hex(w(v.children[0])),raw:w(v.children[1])};function w(E){if(E.value&&E.value instanceof Uint8Array)return E.value;if(E.children)for(let B of E.children){let A=w(B);if(A!=null)return A}return null}}(u),g=Br(e.response.getAuthenticatorData!==void 0?new Uint8Array(e.response.getAuthenticatorData()):CBOR.decode(e.response.attestationObject).authData);if(!Ir(g.rpIdHash,t.relyingPartyID))throw new Error("Unexpected relying-party ID");return g.signCount==0&&delete g.signCount,{request:{credentialType:e.type,...t[t[Q]],challenge:he(t[t[Q]].challenge),...Object.fromEntries(Object.entries(o).filter(([y,d])=>["origin","crossOrigin"].includes(y)))},response:{credentialID:he(new Uint8Array(e.rawId)),credentialType:e.type,authenticatorAttachment:e.authenticatorAttachment,publicKey:{algoCOSE:l,algoOID:s,spki:u,raw:h},...Object.fromEntries(Object.entries(g).filter(([y,d])=>["flags","signCount","userPresence","userVerification"].includes(y))),raw:e.response}}}throw new Error("WebAuthentication not supported on this device")}catch(e){if(e!=vr)throw new Error("Credential registration failed",{cause:e})}}function Er({credentialType:t="publicKey",authenticatorSelection:{authenticatorAttachment:e="platform",userVerification:n="required",residentKey:o="required",requireResidentKey:a=!0,...l}={},relyingPartyID:u=document.location.hostname,relyingPartyName:s="wacl",attestation:h="none",challenge:g=sodium.randombytes_buf(20),excludeCredentials:y=[],user:{name:d="wacl-user",displayName:v=d,id:w=sodium.randombytes_buf(5)}={},publicKeyCredentialParams:E=br.map(S=>({type:"public-key",alg:S.COSEID})),signal:B,...A}={}){var S={[t]:{authenticatorSelection:{authenticatorAttachment:e,userVerification:n,residentKey:o,requireResidentKey:a,...l},attestation:h,rp:{id:u,name:s},user:{name:d,displayName:v,id:w},challenge:g,excludeCredentials:y,pubKeyCredParams:E,...A},...B!=null?{signal:B}:null};return Object.defineProperty(S,Q,{enumerable:!1,writable:!1,configurable:!1,value:t}),S}async function Qt(t=Bt()){try{if(Ut){t[t[Q]].allowCredentials=Sr(t[t[Q]].allowCredentials);let e=await navigator.credentials.get(t),n=new Uint8Array(e.response.clientDataJSON),o=JSON.parse(Dt(n));if(o.type!="webauthn.get")throw new Error("Invalid auth response");let a=sodium.to_base64(t[t[Q]].challenge,sodium.base64_variants.URLSAFE_NO_PADDING);if(o.challenge!=a)throw new Error("Challenge not accepted");let l=Br(new Uint8Array(e.response.authenticatorData));if(!Ir(l.rpIdHash,t.relyingPartyID))throw new Error("Unexpected relying-party ID");l.signCount==0&&delete l.signCount;let u=new Uint8Array(e.response.signature);return{request:{credentialType:e.type,mediation:t.mediation,...t[t[Q]],...Object.fromEntries(Object.entries(o).filter(([s,h])=>["origin","crossOrigin"].includes(s)))},response:{credentialID:he(new Uint8Array(e.rawId)),signature:u,...Object.fromEntries(Object.entries(l).filter(([s,h])=>["flags","signCount","userPresence","userVerification"].includes(s))),...e.response.userHandle!=null?{userID:new Uint8Array(e.response.userHandle)}:null,raw:e.response}}}throw new Error("WebAuthentication not supported on this device")}catch(e){if(e!=vr)throw new Error("Credential auth failed",{cause:e})}}function Bt({credentialType:t="publicKey",relyingPartyID:e=document.location.hostname,userVerification:n="required",challenge:o=sodium.randombytes_buf(20),allowCredentials:a=[],mediation:l="optional",signal:u,...s}={}){var h={[t]:{rpId:e,userVerification:n,challenge:o,allowCredentials:a},mediation:l,...u!=null?{signal:u}:null,...s};return Object.defineProperty(h,Q,{enumerable:!1,writable:!1,configurable:!1,value:t}),h}async function er({signature:t,raw:{clientDataJSON:e,authenticatorData:n}}={},{algoCOSE:o,spki:a,raw:l}={}){try{if(t&&e&&n&&a&&l&&Number.isInteger(o)){let u=function(y,d){if(se("ES256",y)){let v=ASN1.parseVerbose(d);return new Uint8Array([...v.children[0].value,...v.children[1].value])}return d}(o,t),s=await async function(y,d){var v=await xr(d),w=new Uint8Array(y.byteLength+v.byteLength);return w.set(new Uint8Array(y),0),w.set(v,y.byteLength),w}(n,e),h=await(se("Ed25519",o)?function(y,d,v,w){if(se("Ed25519",d))try{return sodium.crypto_sign_verify_detached(v,w,y)}catch{return!1}throw new Error("Unrecognized signature for sodium verification")}(l,o,u,s):se("ES256",o)||se("RS256",o)||se("RSASSA-PSS",o)?async function(y,d,v,w){if(se("ES256",d)||se("RSASSA-PSS",d)||se("RS256",d))try{let E=await crypto.subtle.importKey("spki",y,Ze[d].cipherOpts,!1,["verify"]);return await crypto.subtle.verify(Ze[d].cipherOpts,E,v,w)}catch{return!1}throw new Error("Unrecognized signature for subtle-crypto verification")}(a,o,u,s):null);if(h==null)throw new Error("Unrecognized signature, failed validation");return h}throw new Error("Auth verification missing required inputs")}catch(u){throw new Error("Auth verification failed",{cause:u})}}function Br(t){return{rpIdHash:t.slice(0,32),flags:t[32],userPresence:!(1&~t[32]),userVerification:!(4&~t[32]),signCount:Bn(t.slice(33,37))}}async function Ir(t,e){var n=await xr(kr(e));return t.length>0&&t.byteLength==n.byteLength&&t.toString()==n.toString()}function Bn(t){if(t.byteLength<4){let e=new Uint8Array(4);e.set(t,4-t.byteLength),t=e}return new DataView(t.buffer).getInt32(0)}async function xr(t){return new Uint8Array(await window.crypto.subtle.digest("SHA-256",new Uint8Array(t)))}function se(t,e){return Ze[t]==Ze[e]}function Ar(t,e=!1){return t={...t,spki:typeof t.spki!="string"?he(t.spki):t.spki,raw:typeof t.raw!="string"?he(t.raw):t.raw},e?JSON.stringify(t):t}function In(t){var e=typeof t=="string"?JSON.parse(t):t;return{...e,spki:typeof e.spki=="string"?Qe(e.spki):e.spki,raw:typeof e.raw=="string"?Qe(e.raw):e.raw}}function Sr(t){if(Array.isArray(t))return t.map(e=>({...e,id:typeof e.id=="string"?Qe(e.id):e.id}))}function he(t){return sodium.to_base64(t,sodium.base64_variants.ORIGINAL)}function Qe(t){return sodium.from_base64(t,sodium.base64_variants.ORIGINAL)}function Dt(t){return sodium.to_string(t)}function kr(t){return sodium.from_string(t)}/*! byojs/Storage: util.mjs
    v0.12.1 (c) 2025 Kyle Simpson
    MIT License: http://getify.mit-license.org
*/function Lr(t){if(t!=null&&t!="")try{return JSON.parse(t)}catch{}return t??null}/*! byojs/Storage: adapter.local-storage.mjs
    v0.12.1 (c) 2025 Kyle Simpson
    MIT License: http://getify.mit-license.org
*/It.many=(...t)=>dn(It,...t),xt.many=(...t)=>gn(xt,...t),At.many=(...t)=>wn(At,...t);var xn="local-storage",tr={storageType:xn,has:An,get:It,set:xt,remove:At,keys:Sn,entries:kn};async function An(t){return window.localStorage.getItem(t)!==null}async function It(t){return Lr(window.localStorage.getItem(t))}async function xt(t,e){try{return window.localStorage.setItem(t,e!=null&&typeof e=="object"?JSON.stringify(e):String(e)),!0}catch(n){throw n.name=="QuotaExceededError"?new Error("Local-storage is full.",{cause:n}):n}}async function At(t){return window.localStorage.removeItem(t),!0}async function Sn(){var t=[];for(let e=0;e<window.localStorage.length;e++)t.push(window.localStorage.key(e));return t}async function kn(){var t=[];for(let e=0;e<window.localStorage.length;e++){let n=window.localStorage.key(e);t.push([n,Lr(window.localStorage.getItem(n))])}return t}const et=sodium.crypto_sign_SEEDBYTES;typeof PublicKeyCredential<"u"&&PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable!==void 0&&await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();var Te=null,G=null,X={},P=null,Xe=new WeakMap,Ke=null,st=Fn(18e5),rr="idb";async function Ln(){return await Pt(),Object.keys(G)}function Je(t,e,n=!1){t in X&&!n||(X[t]={...e,timestamp:Date.now()},ct())}function Kn(t){t!=null?delete X[t]:X={},ct()}function ct(){Ke!=null&&(clearTimeout(Ke),Ke=null),function(){if(Ke==null){let e=function(){return(Object.values(X).map(o=>o.timestamp)||[])[0]}();if(e!=null){let n=Math.max(6e4,Math.max(e+st-Date.now(),0)+Math.round(1e4*Math.random()));Ke=setTimeout(Tn,n)}}}()}function Tn(){Ke=null;var t=Date.now(),e=t-Math.min(st,t);Object.entries(X).filter(([n,o])=>o.timestamp<e).forEach(([n])=>{delete X[n]}),ct()}async function Oe({localIdentity:t=he(Rt(15)),username:e="local-user",displayName:n="Local User",relyingPartyID:o=document.location.hostname,relyingPartyName:a="Local Data Lock",addNewPasskey:l=!1,resetLockKey:u=!1,useLockKey:s=null,verify:h=!0,signal:g}={}){await Pt();var y=t!=null?G[t]:null;if(y!=null){let w=function(B){var A=Date.now();if(B in X&&X[B].timestamp>=A-Math.min(st,A)){let{timestamp:S,...m}=X[B];return m}}(t);if(w!=null&&!u){if(l){Re(g);let{record:E}=await d(w)||{};be(P),P=null,E!=null&&(y.lastSeq=E.lastSeq,y.passkeys=[...y.passkeys,...E.passkeys],await mt())}return Object.freeze({...w,localIdentity:t})}if(delete X[t],u){if(Re(g),{record:G[t],lockKey:w}=await d(s&&typeof s=="object"?nr(s):void 0),be(P),P=null,G[t]==null)delete G[t];else if(w!=null)return await mt(),Je(t,w),Object.freeze({...w,localIdentity:t})}else{if(l)throw new Error("Encryption/Decryption key not currently cached, unavailable for new passkey");{Re(g);let E=Bt({relyingPartyID:o,mediation:"optional",allowCredentials:y.passkeys.map(({credentialID:A})=>({type:"public-key",id:A})),signal:P.signal}),B=await Qt(E);if(be(P),P=null,B!=null){if(h){let A=y.passkeys.find(m=>m.credentialID==B.response.credentialID),S=A?.publicKey;if(!(S!=null&&await er(B.response,S)))throw new Error("Auth verification failed")}return{...v(B),localIdentity:t}}}}}else if(l){Re(g);let{record:w,lockKey:E}=await d(s&&typeof s=="object"?nr(s):void 0)||{};if(be(P),P=null,w!=null&&E!=null)return G[t]=w,Je(t,E),await mt(),Object.freeze({...E,localIdentity:t})}else{Re(g);let w=Bt({relyingPartyID:o,mediation:"optional",signal:P.signal}),E=await Qt(w);if(be(P),P=null,E!=null){let B=v(E),[A]=Object.entries(G).find(([,S])=>S.passkeys.find(m=>m.credentialID==E.response.credentialID)!=null)||[];if(A!=null){if(delete X[t],y=G[t=A],h){let S=y.passkeys.find(x=>x.credentialID==E.response.credentialID),m=S?.publicKey;if(!(m!=null&&await er(E.response,m)))throw new Error("Auth verification failed")}Je(t,B)}else if(h)throw new Error("Auth verification requested but skipped, against unrecognized passkey (no matching local-identity)");return Object.freeze({...B,localIdentity:t})}}async function d(w=St()){try{let B=((G[t]||{}).lastSeq||0)+1,A=new Uint8Array(w.iv.byteLength+2),S=new DataView(new ArrayBuffer(2));S.setInt16(0,B,!1),A.set(w.iv,0),A.set(new Uint8Array(S.buffer),w.iv.byteLength);let m=Er({relyingPartyID:o,relyingPartyName:a,user:{id:A,name:e,displayName:n},signal:P.signal}),x=await En(m);if(x!=null)return{record:{lastSeq:B,passkeys:[(E={seq:B,credentialID:x.response.credentialID,publicKey:x.response.publicKey},{...E,hash:Kr(E)})]},lockKey:w}}catch(B){throw new Error("Identity/Passkey registration failed",{cause:B})}var E}function v(w){try{if(w&&w.response&&_t(w.response.userID)&&w.response.userID.byteLength==et+2){let E=St(w.response.userID.slice(0,et));return Je(t,E),E}throw new Error("Passkey info missing")}catch(E){throw new Error("Chosen passkey did not provide a valid encryption/decryption key",{cause:E})}}}function Re(t){if(P&&(be(P),P.aborted||P.abort("Passkey operation abandoned.")),P=new AbortController,t!=null)if(t.aborted)P.abort(t.reason);else{let e=()=>{be(P),P.abort(t.reason),P=t=e=null};t.addEventListener("abort",e),Xe.set(P,[t,e])}}function be(t){if(t!=null&&Xe.has(t)){let[e,n]=Xe.get(t);e.removeEventListener("abort",n),Xe.delete(t)}}function Rt(t=16){return sodium.randombytes_buf(t)}function St(t=Rt(et)){try{let e=sodium.crypto_sign_seed_keypair(t);return{keyFormatVersion:1,iv:t,publicKey:e.publicKey,privateKey:e.privateKey,encPK:sodium.crypto_sign_ed25519_pk_to_curve25519(e.publicKey),encSK:sodium.crypto_sign_ed25519_sk_to_curve25519(e.privateKey)}}catch(e){throw new Error("Encryption/decryption key derivation failed.",{cause:e})}}function nr(t){if(t&&typeof t=="object"){if(t.keyFormatVersion===1)return t;if(_t(t.iv)&&t.iv.byteLength==et)return St(t.iv)}throw new Error("Unrecongnized lock-key")}function lt(t,e,{outputFormat:n="base64"}={}){try{let o=Un(t),a=sodium.crypto_box_seal(o,e.encPK);return["base64","base-64"].includes(n.toLowerCase())?he(a):a}catch(o){throw new Error("Data encryption failed.",{cause:o})}}function Cn(t,e,{outputFormat:n="utf8",parseJSON:o=!0}={}){try{let a=sodium.crypto_box_seal_open(typeof t=="string"?Qe(t):t,e.encPK,e.encSK);if(["utf8","utf-8"].includes(n.toLowerCase())){let l=Dt(a);return o?JSON.parse(l):l}return a}catch(a){throw new Error("Data decryption failed.",{cause:a})}}async function mt(){await Pt();var t=Object.fromEntries(Object.entries(G).map(([e,n])=>[e,{...n,passkeys:n.passkeys.map(o=>({...o,publicKey:Ar(o.publicKey)}))}]));Object.keys(t).length>0?await Te.set("local-identities",t):await Te.remove("local-identities")}function Fn(t){try{return st=Math.max(0,Number(t)||0)}finally{ct()}}function Un(t){var e=t==null?null:t instanceof ArrayBuffer?new Uint8Array(t):_t(t)?t:kr(typeof t=="object"?JSON.stringify(t):typeof t=="string"?t:String(t));if(e==null)throw new Error("Non-empty data required.");return e}function _t(t){return t instanceof Uint8Array&&t.buffer instanceof ArrayBuffer}function Kr(t){let{hash:e,...n}=t;return he(sodium.crypto_hash(JSON.stringify({...n,publicKey:Ar(n.publicKey)})))}async function Pt(){if(Te==null){if(!["idb","local-storage","session-storage","cookie","opfs","opfs-worker"].includes(rr))throw new Error(`Unrecognized storage type ('${rr}')`);Te=await vn(()=>import("./adapter.idb-CmHDc2SO.js"),__vite__mapDeps([0,1]),import.meta.url)}Te!=null&&G==null&&(G=await async function(){return Object.fromEntries(Object.entries(await Te.get("local-identities")||{}).filter(([e,n])=>typeof n.lastSeq=="number"&&Array.isArray(n.passkeys)&&n.passkeys.length>0&&n.passkeys.every(o=>typeof o.credentialID=="string"&&o.credentialID!=""&&typeof o.seq=="number"&&o.publicKey!=null&&typeof o.publicKey=="object"&&typeof o.publicKey.algoCOSE=="number"&&typeof o.publicKey.raw=="string"&&o.publicKey.raw!=""&&typeof o.publicKey.spki=="string"&&o.publicKey.spki!=""&&typeof o.hash=="string"&&o.hash!=""&&o.hash==Kr(o))).map(([e,n])=>[e,{...n,passkeys:n.passkeys.map(o=>({...o,publicKey:In(o.publicKey)}))}]))}())}/*! mylofi/Local-Vault: bundlers/lv.mjs
    v0.17.4 (c) 2025 Kyle Simpson
    MIT License: http://getify.mit-license.org
*/var q={},Y={},de=new WeakMap;function Dn({storageType:t="unknown",read:e,write:n,find:o,clear:a,raw:l}={}){if(t in q)throw new Error(`Storage type ('${t}') already defined`);q[t]={read:e,write:n,find:o,clear:a,raw:{storageType:t,...l}}}function Rn(t){if(q[t]?.raw!=null)return q[t].raw;throw new Error(`Raw-storage type ('${t}') unknown or unavailable`)}async function kt({storageType:t,vaultID:e,keyOptions:{relyingPartyID:n=document.location.hostname,relyingPartyName:o="Local Vault",localIdentity:a,useLockKey:l,...u}={},addNewVault:s=!1,discoverVault:h=!1,signal:g}={}){if(t in q){if(h){if(l!=null)throw new Error("Explicit lock-key not allowed in vault-discovery mode");let y=await Ln(),d=await Oe({...u,relyingPartyID:n,relyingPartyName:o,signal:g});if(d!=null&&y.includes(d.localIdentity)){let[v]=await q[t].find({accountID:d.localIdentity});if(v!=null)return kt({storageType:t,vaultID:v,keyOptions:{relyingPartyID:n,relyingPartyName:o,...u},signal:g})}throw new Error(`No matching vault found in storage ('${t}') for presented passkey`)}if(s||e!=null){if(s&&e==null&&(e=he(Rt(12)).replace(/[^a-zA-Z0-9]+/g,"")),!(e in Y)){Y[e]={id:e,storageType:t,has:Pn,get:Nn,set:On,remove:$n,clear:Mn,lock:Hn,addPasskey:Vn,resetLockKey:jn,keys:zn,entries:qn,__exportLockKey:Yn};for(let[v,w]of Object.entries(Y[e]))typeof w=="function"&&(Y[e][v]=w.bind(Y[e]));Object.freeze(Y[e])}let y=await Tr(t,e);g!=null&&(y.externalSignal=g);let d=s||l==null?s||y.accountID!=null?await Oe({...u,relyingPartyID:y.rpID??n,relyingPartyName:o,...s?{addNewPasskey:!0,localIdentity:a,useLockKey:l}:{localIdentity:y.accountID},signal:g}):null:l;if(d!=null&&d.localIdentity!=null)return Cr(y,d),y.accountID==d.localIdentity&&y.rpID==n||(y.accountID=d.localIdentity,y.rpID=n,await q[t].write(e,y,lt(y.data,d))),Y[e];throw de.delete(Y[e]),delete Y[e],new Error("Vault lock-key access failed")}throw new Error("Required vault ID missing")}throw new Error(`Unknown storage type ('${t}')`)}async function _n(){for(let t of Object.values(q))try{await t.clear()}catch{}return!0}async function Pn(t,{useLockKey:e,signal:n}={}){var{vaultEntry:o}=await ae(this,e,n);if(o!=null)return t in o.data}async function Nn(t,{useLockKey:e,signal:n}={}){var{vaultEntry:o}=await ae(this,e,n);return o?.data?.[t]}async function On(t,e,{useLockKey:n,signal:o}={}){if(e===void 0)return this.remove(t,{useLockKey:n,signal:o});var{storageType:a,vaultID:l,vaultEntry:u,vaultLockKey:s}=await ae(this,n,o)||{};return a!=null&&l!=null&&u!=null&&s!=null&&(u.data[t]=e,await q[a].write(l,u,lt(u.data,s)),!0)}async function $n(t,{useLockKey:e,signal:n}={}){var{storageType:o,vaultID:a,vaultEntry:l,vaultLockKey:u}=await ae(this,e,n)||{};return o!=null&&a!=null&&l!=null&&u!=null&&(delete l.data[t],await q[o].write(a,l,lt(l.data,u)),!0)}async function Mn({useLockKey:t,signal:e}={}){var{storageType:n,vaultID:o}=await ae(this,t,e)||{};return n!=null&&o!=null&&(await q[n].clear(o),de.delete(Y[o]),!0)}function Hn({useLockKey:t}={}){if(t!=null)throw new Error("Explicit lock-key not allowed when locking a vault");var e=this;if(e!=null&&typeof e.storageType=="string"&&typeof e.id=="string"&&de.has(e)){let n=de.get(e);return de.delete(e),Kn(n.accountID),!0}throw new Error("Not a currently unlocked vault")}async function Vn({localIdentity:t,relyingPartyID:e=document.location.hostname,relyingPartyName:n="Local Vault",useLockKey:o,signal:a,...l}={}){if(o!=null)throw new Error("Explicit lock-key not allowed when adding a passkey to a vault");var{vaultEntry:u}=await ae(this,null,a);if(u!=null)try{return await Oe({...l,localIdentity:u.accountID,relyingPartyID:u.rpID??e,relyingPartyName:n,addNewPasskey:!0,signal:a??u.externalSignal??null})!=null}catch(s){throw new Error("Adding passkey to vault's local-account failed",{cause:s})}return!1}async function jn({localIdentity:t,relyingPartyID:e=document.location.hostname,relyingPartyName:n="Local Vault",useLockKey:o,signal:a,...l}={}){var{storageType:u,vaultID:s,vaultEntry:h}=await ae(this,o,a)||{};if(u!=null&&s!=null&&h!=null)try{let g=await Oe({...l,localIdentity:h.accountID,relyingPartyID:h.rpID??e,relyingPartyName:n,resetLockKey:!0,useLockKey:o,signal:a??h.externalSignal??null});if(g!=null)return await q[u].write(s,h,lt(h.data,g)),!0}catch(g){throw new Error("Resetting vault's lock-key failed",{cause:g})}return!1}async function zn({useLockKey:t,signal:e}={}){var{vaultEntry:n}=await ae(this,t,e)||{};return n!=null?Object.keys(n.data):[]}async function qn({useLockKey:t,signal:e}={}){var{vaultEntry:n}=await ae(this,t,e)||{};return n!=null?Object.entries(n.data):[]}async function Yn({risky:t=!1,useLockKey:e,signal:n}={}){if(t=="this is unsafe"){if(e!=null)throw new Error("Explicit lock-key not allowed when exporting existing lock-key");return(await ae(this,null,n)||{}).vaultLockKey}throw new Error('Must pass {risky:"this is unsafe"} argument, to acknowledge the risks of using this method')}async function ae(t,e,n){if(t==null||typeof t.storageType!="string"||typeof t.id!="string")throw new Error("Unrecognized vault instance");{let{storageType:o,id:a}=t;if(q[o]==null)throw new Error(`Unknown storage type ('${o}')`);{let l=await Tr(o,a),u=e??await Oe({localIdentity:l.accountID,relyingPartyID:l.rpID,signal:n});if(u!=null)return Cr(l,u),{storageType:o,vaultID:a,vaultEntry:l,vaultLockKey:u}}}}async function Tr(t,e){var n=de.has(Y[e])?de.get(Y[e]):await q[t].read(e);return de.set(Y[e],n),n}function Cr(t,e){typeof t.data=="string"&&(t.data=t.data.length>0?Cn(t.data,e):{})}/*! mylofi/Local-Vault: bundlers/base-adapter.mjs
    v0.17.4 (c) 2025 Kyle Simpson
    MIT License: http://getify.mit-license.org
*/function Jn(t){return{read:async function(o,a){var l=await t.get(`local-vault-${o}`);return l??(await e(o,a,""),t.get(`local-vault-${o}`))},write:e,find:async function(o){var a=Object.entries(o);for(let[l,u]of await t.entries()){let[,s]=l.match(/^local-vault-([^]+)$/)||[];if(s!=null&&u!=null&&a.every(([h,g])=>u[h]==g))return[s,u]}return[]},clear:async function(o=null){if(o!=null)return t.remove(`local-vault-${o}`);for(let a of(await t.keys()).filter(l=>/^local-vault-[^]+$/.test(l)))await t.remove(a);return!0}};async function e(n,o,a){return t.set(`local-vault-${n}`,{...o,data:a})}}/*! mylofi/Local-Vault: bundlers/adapter.local-storage.mjs
    v0.17.4 (c) 2025 Kyle Simpson
    MIT License: http://getify.mit-license.org
*/try{Dn({storageType:"local-storage",...Jn(tr),raw:tr})}catch{}class ue extends EventTarget{static instance=null;#e=null;#t=!1;#n=Rn("local-storage");#r=new AbortController;constructor(){if(super(),ue.instance)return ue.instance;ue.instance=this}static getInstance(){return ue.instance||(ue.instance=new ue),ue.instance}get isAuth(){return this.#t}set isAuth(e){this.#t!==e&&(this.#t=e,this.dispatchEvent(new CustomEvent("authChange",{detail:{isAuth:e}})))}async initialize(){try{const e=await this.getVaultID();e?await this.connectToVault(e):await this.createVault()}catch(e){await this.handleError(e,"Error during storage initialization")}}async createVault(){try{this.#e=await kt({storageType:"local-storage",addNewVault:!0,keyOptions:{username:"biometric-user",displayName:"Biometric User"},signal:this.#r.signal}),await this.saveVaultID(this.#e.id),this.isAuth=!0}catch(e){await this.handleError(e,"Error creating a new vault")}}async connectToVault(e){try{this.#e=await kt({vaultID:e,storageType:"local-storage",signal:this.#r.signal}),this.isAuth=!0}catch{this.isAuth=!1}}async setData(e){try{await this.ensureVault();const n=await this.getVaultID();await this.#e.set(n,e,{signal:this.#r.signal})}catch(n){await this.handleError(n,"Error saving data")}}async getData(){try{await this.ensureVault();const e=await this.getVaultID();return await this.#e.get(e,{signal:this.#r.signal})}catch(e){await this.handleError(e,"Error retrieving data")}}async hasVault(){try{return!!await this.getVaultID()}catch{return!1}}async clearVault(){try{await _n(),await this.removeVaultID(),this.#e=null,this.isAuth=!1}catch{}}async getVaultID(){return await this.#n.get("vault-id")}async saveVaultID(e){await this.#n.set("vault-id",e)}async removeVaultID(){await this.#n.remove("vault-id")}async ensureVault(){this.#e||await this.initialize()}async handleError(e,n){this.isAuth=!1,this.isCancelError(e)&&await this.clearVault()}isCancelError(e){return e.message?.includes("The operation either timed out or was not allowed")||e.message?.includes("Credential auth failed")||e.message?.includes("Identity/Passkey registration failed")||e.name==="AbortError"}cancelOperation(e="Operation canceled"){this.#r&&(this.isAuth=!1,this.#r.abort(e),this.#r=new AbortController)}}var Ce=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Wn(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(o){var a=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(n,o,a.get?a:{enumerable:!0,get:function(){return t[o]}})}),n}var F={},ut={};ut.byteLength=Zn;ut.toByteArray=ei;ut.fromByteArray=ni;var ne=[],W=[],Gn=typeof Uint8Array<"u"?Uint8Array:Array,bt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Le=0,Xn=bt.length;Le<Xn;++Le)ne[Le]=bt[Le],W[bt.charCodeAt(Le)]=Le;W[45]=62;W[95]=63;function Ur(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var o=n===e?0:4-n%4;return[n,o]}function Zn(t){var e=Ur(t),n=e[0],o=e[1];return(n+o)*3/4-o}function Qn(t,e,n){return(e+n)*3/4-n}function ei(t){var e,n=Ur(t),o=n[0],a=n[1],l=new Gn(Qn(t,o,a)),u=0,s=a>0?o-4:o,h;for(h=0;h<s;h+=4)e=W[t.charCodeAt(h)]<<18|W[t.charCodeAt(h+1)]<<12|W[t.charCodeAt(h+2)]<<6|W[t.charCodeAt(h+3)],l[u++]=e>>16&255,l[u++]=e>>8&255,l[u++]=e&255;return a===2&&(e=W[t.charCodeAt(h)]<<2|W[t.charCodeAt(h+1)]>>4,l[u++]=e&255),a===1&&(e=W[t.charCodeAt(h)]<<10|W[t.charCodeAt(h+1)]<<4|W[t.charCodeAt(h+2)]>>2,l[u++]=e>>8&255,l[u++]=e&255),l}function ti(t){return ne[t>>18&63]+ne[t>>12&63]+ne[t>>6&63]+ne[t&63]}function ri(t,e,n){for(var o,a=[],l=e;l<n;l+=3)o=(t[l]<<16&16711680)+(t[l+1]<<8&65280)+(t[l+2]&255),a.push(ti(o));return a.join("")}function ni(t){for(var e,n=t.length,o=n%3,a=[],l=16383,u=0,s=n-o;u<s;u+=l)a.push(ri(t,u,u+l>s?s:u+l));return o===1?(e=t[n-1],a.push(ne[e>>2]+ne[e<<4&63]+"==")):o===2&&(e=(t[n-2]<<8)+t[n-1],a.push(ne[e>>10]+ne[e>>4&63]+ne[e<<2&63]+"=")),a.join("")}var Nt={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Nt.read=function(t,e,n,o,a){var l,u,s=a*8-o-1,h=(1<<s)-1,g=h>>1,y=-7,d=n?a-1:0,v=n?-1:1,w=t[e+d];for(d+=v,l=w&(1<<-y)-1,w>>=-y,y+=s;y>0;l=l*256+t[e+d],d+=v,y-=8);for(u=l&(1<<-y)-1,l>>=-y,y+=o;y>0;u=u*256+t[e+d],d+=v,y-=8);if(l===0)l=1-g;else{if(l===h)return u?NaN:(w?-1:1)*(1/0);u=u+Math.pow(2,o),l=l-g}return(w?-1:1)*u*Math.pow(2,l-o)};Nt.write=function(t,e,n,o,a,l){var u,s,h,g=l*8-a-1,y=(1<<g)-1,d=y>>1,v=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=o?0:l-1,E=o?1:-1,B=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,u=y):(u=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-u))<1&&(u--,h*=2),u+d>=1?e+=v/h:e+=v*Math.pow(2,1-d),e*h>=2&&(u++,h/=2),u+d>=y?(s=0,u=y):u+d>=1?(s=(e*h-1)*Math.pow(2,a),u=u+d):(s=e*Math.pow(2,d-1)*Math.pow(2,a),u=0));a>=8;t[n+w]=s&255,w+=E,s/=256,a-=8);for(u=u<<a|s,g+=a;g>0;t[n+w]=u&255,w+=E,u/=256,g-=8);t[n+w-E]|=B*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=ut,n=Nt,o=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=m,t.INSPECT_MAX_BYTES=50;const a=2147483647;t.kMaxLength=a,s.TYPED_ARRAY_SUPPORT=l(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u";function l(){try{const c=new Uint8Array(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,Uint8Array.prototype),Object.setPrototypeOf(c,r),c.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function u(c){if(c>a)throw new RangeError('The value "'+c+'" is invalid for option "size"');const r=new Uint8Array(c);return Object.setPrototypeOf(r,s.prototype),r}function s(c,r,i){if(typeof c=="number"){if(typeof r=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(c)}return h(c,r,i)}s.poolSize=8192;function h(c,r,i){if(typeof c=="string")return v(c,r);if(ArrayBuffer.isView(c))return E(c);if(c==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c);if(re(c,ArrayBuffer)||c&&re(c.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(re(c,SharedArrayBuffer)||c&&re(c.buffer,SharedArrayBuffer)))return B(c,r,i);if(typeof c=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const f=c.valueOf&&c.valueOf();if(f!=null&&f!==c)return s.from(f,r,i);const p=A(c);if(p)return p;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof c[Symbol.toPrimitive]=="function")return s.from(c[Symbol.toPrimitive]("string"),r,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c)}s.from=function(c,r,i){return h(c,r,i)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function g(c){if(typeof c!="number")throw new TypeError('"size" argument must be of type number');if(c<0)throw new RangeError('The value "'+c+'" is invalid for option "size"')}function y(c,r,i){return g(c),c<=0?u(c):r!==void 0?typeof i=="string"?u(c).fill(r,i):u(c).fill(r):u(c)}s.alloc=function(c,r,i){return y(c,r,i)};function d(c){return g(c),u(c<0?0:S(c)|0)}s.allocUnsafe=function(c){return d(c)},s.allocUnsafeSlow=function(c){return d(c)};function v(c,r){if((typeof r!="string"||r==="")&&(r="utf8"),!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);const i=x(c,r)|0;let f=u(i);const p=f.write(c,r);return p!==i&&(f=f.slice(0,p)),f}function w(c){const r=c.length<0?0:S(c.length)|0,i=u(r);for(let f=0;f<r;f+=1)i[f]=c[f]&255;return i}function E(c){if(re(c,Uint8Array)){const r=new Uint8Array(c);return B(r.buffer,r.byteOffset,r.byteLength)}return w(c)}function B(c,r,i){if(r<0||c.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(c.byteLength<r+(i||0))throw new RangeError('"length" is outside of buffer bounds');let f;return r===void 0&&i===void 0?f=new Uint8Array(c):i===void 0?f=new Uint8Array(c,r):f=new Uint8Array(c,r,i),Object.setPrototypeOf(f,s.prototype),f}function A(c){if(s.isBuffer(c)){const r=S(c.length)|0,i=u(r);return i.length===0||c.copy(i,0,0,r),i}if(c.length!==void 0)return typeof c.length!="number"||wt(c.length)?u(0):w(c);if(c.type==="Buffer"&&Array.isArray(c.data))return w(c.data)}function S(c){if(c>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return c|0}function m(c){return+c!=c&&(c=0),s.alloc(+c)}s.isBuffer=function(r){return r!=null&&r._isBuffer===!0&&r!==s.prototype},s.compare=function(r,i){if(re(r,Uint8Array)&&(r=s.from(r,r.offset,r.byteLength)),re(i,Uint8Array)&&(i=s.from(i,i.offset,i.byteLength)),!s.isBuffer(r)||!s.isBuffer(i))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===i)return 0;let f=r.length,p=i.length;for(let b=0,I=Math.min(f,p);b<I;++b)if(r[b]!==i[b]){f=r[b],p=i[b];break}return f<p?-1:p<f?1:0},s.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(r,i){if(!Array.isArray(r))throw new TypeError('"list" argument must be an Array of Buffers');if(r.length===0)return s.alloc(0);let f;if(i===void 0)for(i=0,f=0;f<r.length;++f)i+=r[f].length;const p=s.allocUnsafe(i);let b=0;for(f=0;f<r.length;++f){let I=r[f];if(re(I,Uint8Array))b+I.length>p.length?(s.isBuffer(I)||(I=s.from(I)),I.copy(p,b)):Uint8Array.prototype.set.call(p,I,b);else if(s.isBuffer(I))I.copy(p,b);else throw new TypeError('"list" argument must be an Array of Buffers');b+=I.length}return p};function x(c,r){if(s.isBuffer(c))return c.length;if(ArrayBuffer.isView(c)||re(c,ArrayBuffer))return c.byteLength;if(typeof c!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof c);const i=c.length,f=arguments.length>2&&arguments[2]===!0;if(!f&&i===0)return 0;let p=!1;for(;;)switch(r){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return gt(c).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i*2;case"hex":return i>>>1;case"base64":return Xt(c).length;default:if(p)return f?-1:gt(c).length;r=(""+r).toLowerCase(),p=!0}}s.byteLength=x;function L(c,r,i){let f=!1;if((r===void 0||r<0)&&(r=0),r>this.length||((i===void 0||i>this.length)&&(i=this.length),i<=0)||(i>>>=0,r>>>=0,i<=r))return"";for(c||(c="utf8");;)switch(c){case"hex":return an(this,r,i);case"utf8":case"utf-8":return Ve(this,r,i);case"ascii":return ze(this,r,i);case"latin1":case"binary":return yt(this,r,i);case"base64":return ht(this,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return sn(this,r,i);default:if(f)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),f=!0}}s.prototype._isBuffer=!0;function K(c,r,i){const f=c[r];c[r]=c[i],c[i]=f}s.prototype.swap16=function(){const r=this.length;if(r%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let i=0;i<r;i+=2)K(this,i,i+1);return this},s.prototype.swap32=function(){const r=this.length;if(r%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let i=0;i<r;i+=4)K(this,i,i+3),K(this,i+1,i+2);return this},s.prototype.swap64=function(){const r=this.length;if(r%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let i=0;i<r;i+=8)K(this,i,i+7),K(this,i+1,i+6),K(this,i+2,i+5),K(this,i+3,i+4);return this},s.prototype.toString=function(){const r=this.length;return r===0?"":arguments.length===0?Ve(this,0,r):L.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(r){if(!s.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r?!0:s.compare(this,r)===0},s.prototype.inspect=function(){let r="";const i=t.INSPECT_MAX_BYTES;return r=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(r+=" ... "),"<Buffer "+r+">"},o&&(s.prototype[o]=s.prototype.inspect),s.prototype.compare=function(r,i,f,p,b){if(re(r,Uint8Array)&&(r=s.from(r,r.offset,r.byteLength)),!s.isBuffer(r))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof r);if(i===void 0&&(i=0),f===void 0&&(f=r?r.length:0),p===void 0&&(p=0),b===void 0&&(b=this.length),i<0||f>r.length||p<0||b>this.length)throw new RangeError("out of range index");if(p>=b&&i>=f)return 0;if(p>=b)return-1;if(i>=f)return 1;if(i>>>=0,f>>>=0,p>>>=0,b>>>=0,this===r)return 0;let I=b-p,T=f-i;const N=Math.min(I,T),_=this.slice(p,b),O=r.slice(i,f);for(let R=0;R<N;++R)if(_[R]!==O[R]){I=_[R],T=O[R];break}return I<T?-1:T<I?1:0};function U(c,r,i,f,p){if(c.length===0)return-1;if(typeof i=="string"?(f=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,wt(i)&&(i=p?0:c.length-1),i<0&&(i=c.length+i),i>=c.length){if(p)return-1;i=c.length-1}else if(i<0)if(p)i=0;else return-1;if(typeof r=="string"&&(r=s.from(r,f)),s.isBuffer(r))return r.length===0?-1:D(c,r,i,f,p);if(typeof r=="number")return r=r&255,typeof Uint8Array.prototype.indexOf=="function"?p?Uint8Array.prototype.indexOf.call(c,r,i):Uint8Array.prototype.lastIndexOf.call(c,r,i):D(c,[r],i,f,p);throw new TypeError("val must be string, number or Buffer")}function D(c,r,i,f,p){let b=1,I=c.length,T=r.length;if(f!==void 0&&(f=String(f).toLowerCase(),f==="ucs2"||f==="ucs-2"||f==="utf16le"||f==="utf-16le")){if(c.length<2||r.length<2)return-1;b=2,I/=2,T/=2,i/=2}function N(O,R){return b===1?O[R]:O.readUInt16BE(R*b)}let _;if(p){let O=-1;for(_=i;_<I;_++)if(N(c,_)===N(r,O===-1?0:_-O)){if(O===-1&&(O=_),_-O+1===T)return O*b}else O!==-1&&(_-=_-O),O=-1}else for(i+T>I&&(i=I-T),_=i;_>=0;_--){let O=!0;for(let R=0;R<T;R++)if(N(c,_+R)!==N(r,R)){O=!1;break}if(O)return _}return-1}s.prototype.includes=function(r,i,f){return this.indexOf(r,i,f)!==-1},s.prototype.indexOf=function(r,i,f){return U(this,r,i,f,!0)},s.prototype.lastIndexOf=function(r,i,f){return U(this,r,i,f,!1)};function $(c,r,i,f){i=Number(i)||0;const p=c.length-i;f?(f=Number(f),f>p&&(f=p)):f=p;const b=r.length;f>b/2&&(f=b/2);let I;for(I=0;I<f;++I){const T=parseInt(r.substr(I*2,2),16);if(wt(T))return I;c[i+I]=T}return I}function H(c,r,i,f){return qe(gt(r,c.length-i),c,i,f)}function pe(c,r,i,f){return qe(fn(r),c,i,f)}function te(c,r,i,f){return qe(Xt(r),c,i,f)}function me(c,r,i,f){return qe(hn(r,c.length-i),c,i,f)}s.prototype.write=function(r,i,f,p){if(i===void 0)p="utf8",f=this.length,i=0;else if(f===void 0&&typeof i=="string")p=i,f=this.length,i=0;else if(isFinite(i))i=i>>>0,isFinite(f)?(f=f>>>0,p===void 0&&(p="utf8")):(p=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const b=this.length-i;if((f===void 0||f>b)&&(f=b),r.length>0&&(f<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");p||(p="utf8");let I=!1;for(;;)switch(p){case"hex":return $(this,r,i,f);case"utf8":case"utf-8":return H(this,r,i,f);case"ascii":case"latin1":case"binary":return pe(this,r,i,f);case"base64":return te(this,r,i,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return me(this,r,i,f);default:if(I)throw new TypeError("Unknown encoding: "+p);p=(""+p).toLowerCase(),I=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ht(c,r,i){return r===0&&i===c.length?e.fromByteArray(c):e.fromByteArray(c.slice(r,i))}function Ve(c,r,i){i=Math.min(c.length,i);const f=[];let p=r;for(;p<i;){const b=c[p];let I=null,T=b>239?4:b>223?3:b>191?2:1;if(p+T<=i){let N,_,O,R;switch(T){case 1:b<128&&(I=b);break;case 2:N=c[p+1],(N&192)===128&&(R=(b&31)<<6|N&63,R>127&&(I=R));break;case 3:N=c[p+1],_=c[p+2],(N&192)===128&&(_&192)===128&&(R=(b&15)<<12|(N&63)<<6|_&63,R>2047&&(R<55296||R>57343)&&(I=R));break;case 4:N=c[p+1],_=c[p+2],O=c[p+3],(N&192)===128&&(_&192)===128&&(O&192)===128&&(R=(b&15)<<18|(N&63)<<12|(_&63)<<6|O&63,R>65535&&R<1114112&&(I=R))}}I===null?(I=65533,T=1):I>65535&&(I-=65536,f.push(I>>>10&1023|55296),I=56320|I&1023),f.push(I),p+=T}return pt(f)}const je=4096;function pt(c){const r=c.length;if(r<=je)return String.fromCharCode.apply(String,c);let i="",f=0;for(;f<r;)i+=String.fromCharCode.apply(String,c.slice(f,f+=je));return i}function ze(c,r,i){let f="";i=Math.min(c.length,i);for(let p=r;p<i;++p)f+=String.fromCharCode(c[p]&127);return f}function yt(c,r,i){let f="";i=Math.min(c.length,i);for(let p=r;p<i;++p)f+=String.fromCharCode(c[p]);return f}function an(c,r,i){const f=c.length;(!r||r<0)&&(r=0),(!i||i<0||i>f)&&(i=f);let p="";for(let b=r;b<i;++b)p+=pn[c[b]];return p}function sn(c,r,i){const f=c.slice(r,i);let p="";for(let b=0;b<f.length-1;b+=2)p+=String.fromCharCode(f[b]+f[b+1]*256);return p}s.prototype.slice=function(r,i){const f=this.length;r=~~r,i=i===void 0?f:~~i,r<0?(r+=f,r<0&&(r=0)):r>f&&(r=f),i<0?(i+=f,i<0&&(i=0)):i>f&&(i=f),i<r&&(i=r);const p=this.subarray(r,i);return Object.setPrototypeOf(p,s.prototype),p};function V(c,r,i){if(c%1!==0||c<0)throw new RangeError("offset is not uint");if(c+r>i)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(r,i,f){r=r>>>0,i=i>>>0,f||V(r,i,this.length);let p=this[r],b=1,I=0;for(;++I<i&&(b*=256);)p+=this[r+I]*b;return p},s.prototype.readUintBE=s.prototype.readUIntBE=function(r,i,f){r=r>>>0,i=i>>>0,f||V(r,i,this.length);let p=this[r+--i],b=1;for(;i>0&&(b*=256);)p+=this[r+--i]*b;return p},s.prototype.readUint8=s.prototype.readUInt8=function(r,i){return r=r>>>0,i||V(r,1,this.length),this[r]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(r,i){return r=r>>>0,i||V(r,2,this.length),this[r]|this[r+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(r,i){return r=r>>>0,i||V(r,2,this.length),this[r]<<8|this[r+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(r,i){return r=r>>>0,i||V(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+this[r+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(r,i){return r=r>>>0,i||V(r,4,this.length),this[r]*16777216+(this[r+1]<<16|this[r+2]<<8|this[r+3])},s.prototype.readBigUInt64LE=ye(function(r){r=r>>>0,ke(r,"offset");const i=this[r],f=this[r+7];(i===void 0||f===void 0)&&De(r,this.length-8);const p=i+this[++r]*2**8+this[++r]*2**16+this[++r]*2**24,b=this[++r]+this[++r]*2**8+this[++r]*2**16+f*2**24;return BigInt(p)+(BigInt(b)<<BigInt(32))}),s.prototype.readBigUInt64BE=ye(function(r){r=r>>>0,ke(r,"offset");const i=this[r],f=this[r+7];(i===void 0||f===void 0)&&De(r,this.length-8);const p=i*2**24+this[++r]*2**16+this[++r]*2**8+this[++r],b=this[++r]*2**24+this[++r]*2**16+this[++r]*2**8+f;return(BigInt(p)<<BigInt(32))+BigInt(b)}),s.prototype.readIntLE=function(r,i,f){r=r>>>0,i=i>>>0,f||V(r,i,this.length);let p=this[r],b=1,I=0;for(;++I<i&&(b*=256);)p+=this[r+I]*b;return b*=128,p>=b&&(p-=Math.pow(2,8*i)),p},s.prototype.readIntBE=function(r,i,f){r=r>>>0,i=i>>>0,f||V(r,i,this.length);let p=i,b=1,I=this[r+--p];for(;p>0&&(b*=256);)I+=this[r+--p]*b;return b*=128,I>=b&&(I-=Math.pow(2,8*i)),I},s.prototype.readInt8=function(r,i){return r=r>>>0,i||V(r,1,this.length),this[r]&128?(255-this[r]+1)*-1:this[r]},s.prototype.readInt16LE=function(r,i){r=r>>>0,i||V(r,2,this.length);const f=this[r]|this[r+1]<<8;return f&32768?f|4294901760:f},s.prototype.readInt16BE=function(r,i){r=r>>>0,i||V(r,2,this.length);const f=this[r+1]|this[r]<<8;return f&32768?f|4294901760:f},s.prototype.readInt32LE=function(r,i){return r=r>>>0,i||V(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},s.prototype.readInt32BE=function(r,i){return r=r>>>0,i||V(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},s.prototype.readBigInt64LE=ye(function(r){r=r>>>0,ke(r,"offset");const i=this[r],f=this[r+7];(i===void 0||f===void 0)&&De(r,this.length-8);const p=this[r+4]+this[r+5]*2**8+this[r+6]*2**16+(f<<24);return(BigInt(p)<<BigInt(32))+BigInt(i+this[++r]*2**8+this[++r]*2**16+this[++r]*2**24)}),s.prototype.readBigInt64BE=ye(function(r){r=r>>>0,ke(r,"offset");const i=this[r],f=this[r+7];(i===void 0||f===void 0)&&De(r,this.length-8);const p=(i<<24)+this[++r]*2**16+this[++r]*2**8+this[++r];return(BigInt(p)<<BigInt(32))+BigInt(this[++r]*2**24+this[++r]*2**16+this[++r]*2**8+f)}),s.prototype.readFloatLE=function(r,i){return r=r>>>0,i||V(r,4,this.length),n.read(this,r,!0,23,4)},s.prototype.readFloatBE=function(r,i){return r=r>>>0,i||V(r,4,this.length),n.read(this,r,!1,23,4)},s.prototype.readDoubleLE=function(r,i){return r=r>>>0,i||V(r,8,this.length),n.read(this,r,!0,52,8)},s.prototype.readDoubleBE=function(r,i){return r=r>>>0,i||V(r,8,this.length),n.read(this,r,!1,52,8)};function z(c,r,i,f,p,b){if(!s.isBuffer(c))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>p||r<b)throw new RangeError('"value" argument is out of bounds');if(i+f>c.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(r,i,f,p){if(r=+r,i=i>>>0,f=f>>>0,!p){const T=Math.pow(2,8*f)-1;z(this,r,i,f,T,0)}let b=1,I=0;for(this[i]=r&255;++I<f&&(b*=256);)this[i+I]=r/b&255;return i+f},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(r,i,f,p){if(r=+r,i=i>>>0,f=f>>>0,!p){const T=Math.pow(2,8*f)-1;z(this,r,i,f,T,0)}let b=f-1,I=1;for(this[i+b]=r&255;--b>=0&&(I*=256);)this[i+b]=r/I&255;return i+f},s.prototype.writeUint8=s.prototype.writeUInt8=function(r,i,f){return r=+r,i=i>>>0,f||z(this,r,i,1,255,0),this[i]=r&255,i+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(r,i,f){return r=+r,i=i>>>0,f||z(this,r,i,2,65535,0),this[i]=r&255,this[i+1]=r>>>8,i+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(r,i,f){return r=+r,i=i>>>0,f||z(this,r,i,2,65535,0),this[i]=r>>>8,this[i+1]=r&255,i+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(r,i,f){return r=+r,i=i>>>0,f||z(this,r,i,4,4294967295,0),this[i+3]=r>>>24,this[i+2]=r>>>16,this[i+1]=r>>>8,this[i]=r&255,i+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(r,i,f){return r=+r,i=i>>>0,f||z(this,r,i,4,4294967295,0),this[i]=r>>>24,this[i+1]=r>>>16,this[i+2]=r>>>8,this[i+3]=r&255,i+4};function jt(c,r,i,f,p){Gt(r,f,p,c,i,7);let b=Number(r&BigInt(4294967295));c[i++]=b,b=b>>8,c[i++]=b,b=b>>8,c[i++]=b,b=b>>8,c[i++]=b;let I=Number(r>>BigInt(32)&BigInt(4294967295));return c[i++]=I,I=I>>8,c[i++]=I,I=I>>8,c[i++]=I,I=I>>8,c[i++]=I,i}function zt(c,r,i,f,p){Gt(r,f,p,c,i,7);let b=Number(r&BigInt(4294967295));c[i+7]=b,b=b>>8,c[i+6]=b,b=b>>8,c[i+5]=b,b=b>>8,c[i+4]=b;let I=Number(r>>BigInt(32)&BigInt(4294967295));return c[i+3]=I,I=I>>8,c[i+2]=I,I=I>>8,c[i+1]=I,I=I>>8,c[i]=I,i+8}s.prototype.writeBigUInt64LE=ye(function(r,i=0){return jt(this,r,i,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=ye(function(r,i=0){return zt(this,r,i,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(r,i,f,p){if(r=+r,i=i>>>0,!p){const N=Math.pow(2,8*f-1);z(this,r,i,f,N-1,-N)}let b=0,I=1,T=0;for(this[i]=r&255;++b<f&&(I*=256);)r<0&&T===0&&this[i+b-1]!==0&&(T=1),this[i+b]=(r/I>>0)-T&255;return i+f},s.prototype.writeIntBE=function(r,i,f,p){if(r=+r,i=i>>>0,!p){const N=Math.pow(2,8*f-1);z(this,r,i,f,N-1,-N)}let b=f-1,I=1,T=0;for(this[i+b]=r&255;--b>=0&&(I*=256);)r<0&&T===0&&this[i+b+1]!==0&&(T=1),this[i+b]=(r/I>>0)-T&255;return i+f},s.prototype.writeInt8=function(r,i,f){return r=+r,i=i>>>0,f||z(this,r,i,1,127,-128),r<0&&(r=255+r+1),this[i]=r&255,i+1},s.prototype.writeInt16LE=function(r,i,f){return r=+r,i=i>>>0,f||z(this,r,i,2,32767,-32768),this[i]=r&255,this[i+1]=r>>>8,i+2},s.prototype.writeInt16BE=function(r,i,f){return r=+r,i=i>>>0,f||z(this,r,i,2,32767,-32768),this[i]=r>>>8,this[i+1]=r&255,i+2},s.prototype.writeInt32LE=function(r,i,f){return r=+r,i=i>>>0,f||z(this,r,i,4,2147483647,-2147483648),this[i]=r&255,this[i+1]=r>>>8,this[i+2]=r>>>16,this[i+3]=r>>>24,i+4},s.prototype.writeInt32BE=function(r,i,f){return r=+r,i=i>>>0,f||z(this,r,i,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),this[i]=r>>>24,this[i+1]=r>>>16,this[i+2]=r>>>8,this[i+3]=r&255,i+4},s.prototype.writeBigInt64LE=ye(function(r,i=0){return jt(this,r,i,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=ye(function(r,i=0){return zt(this,r,i,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function qt(c,r,i,f,p,b){if(i+f>c.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function Yt(c,r,i,f,p){return r=+r,i=i>>>0,p||qt(c,r,i,4),n.write(c,r,i,f,23,4),i+4}s.prototype.writeFloatLE=function(r,i,f){return Yt(this,r,i,!0,f)},s.prototype.writeFloatBE=function(r,i,f){return Yt(this,r,i,!1,f)};function Jt(c,r,i,f,p){return r=+r,i=i>>>0,p||qt(c,r,i,8),n.write(c,r,i,f,52,8),i+8}s.prototype.writeDoubleLE=function(r,i,f){return Jt(this,r,i,!0,f)},s.prototype.writeDoubleBE=function(r,i,f){return Jt(this,r,i,!1,f)},s.prototype.copy=function(r,i,f,p){if(!s.isBuffer(r))throw new TypeError("argument should be a Buffer");if(f||(f=0),!p&&p!==0&&(p=this.length),i>=r.length&&(i=r.length),i||(i=0),p>0&&p<f&&(p=f),p===f||r.length===0||this.length===0)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("Index out of range");if(p<0)throw new RangeError("sourceEnd out of bounds");p>this.length&&(p=this.length),r.length-i<p-f&&(p=r.length-i+f);const b=p-f;return this===r&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(i,f,p):Uint8Array.prototype.set.call(r,this.subarray(f,p),i),b},s.prototype.fill=function(r,i,f,p){if(typeof r=="string"){if(typeof i=="string"?(p=i,i=0,f=this.length):typeof f=="string"&&(p=f,f=this.length),p!==void 0&&typeof p!="string")throw new TypeError("encoding must be a string");if(typeof p=="string"&&!s.isEncoding(p))throw new TypeError("Unknown encoding: "+p);if(r.length===1){const I=r.charCodeAt(0);(p==="utf8"&&I<128||p==="latin1")&&(r=I)}}else typeof r=="number"?r=r&255:typeof r=="boolean"&&(r=Number(r));if(i<0||this.length<i||this.length<f)throw new RangeError("Out of range index");if(f<=i)return this;i=i>>>0,f=f===void 0?this.length:f>>>0,r||(r=0);let b;if(typeof r=="number")for(b=i;b<f;++b)this[b]=r;else{const I=s.isBuffer(r)?r:s.from(r,p),T=I.length;if(T===0)throw new TypeError('The value "'+r+'" is invalid for argument "value"');for(b=0;b<f-i;++b)this[b+i]=I[b%T]}return this};const Se={};function dt(c,r,i){Se[c]=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:r.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${c}]`,this.stack,delete this.name}get code(){return c}set code(p){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:p,writable:!0})}toString(){return`${this.name} [${c}]: ${this.message}`}}}dt("ERR_BUFFER_OUT_OF_BOUNDS",function(c){return c?`${c} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),dt("ERR_INVALID_ARG_TYPE",function(c,r){return`The "${c}" argument must be of type number. Received type ${typeof r}`},TypeError),dt("ERR_OUT_OF_RANGE",function(c,r,i){let f=`The value of "${c}" is out of range.`,p=i;return Number.isInteger(i)&&Math.abs(i)>2**32?p=Wt(String(i)):typeof i=="bigint"&&(p=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(p=Wt(p)),p+="n"),f+=` It must be ${r}. Received ${p}`,f},RangeError);function Wt(c){let r="",i=c.length;const f=c[0]==="-"?1:0;for(;i>=f+4;i-=3)r=`_${c.slice(i-3,i)}${r}`;return`${c.slice(0,i)}${r}`}function cn(c,r,i){ke(r,"offset"),(c[r]===void 0||c[r+i]===void 0)&&De(r,c.length-(i+1))}function Gt(c,r,i,f,p,b){if(c>i||c<r){const I=typeof r=="bigint"?"n":"";let T;throw r===0||r===BigInt(0)?T=`>= 0${I} and < 2${I} ** ${(b+1)*8}${I}`:T=`>= -(2${I} ** ${(b+1)*8-1}${I}) and < 2 ** ${(b+1)*8-1}${I}`,new Se.ERR_OUT_OF_RANGE("value",T,c)}cn(f,p,b)}function ke(c,r){if(typeof c!="number")throw new Se.ERR_INVALID_ARG_TYPE(r,"number",c)}function De(c,r,i){throw Math.floor(c)!==c?(ke(c,i),new Se.ERR_OUT_OF_RANGE("offset","an integer",c)):r<0?new Se.ERR_BUFFER_OUT_OF_BOUNDS:new Se.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${r}`,c)}const ln=/[^+/0-9A-Za-z-_]/g;function un(c){if(c=c.split("=")[0],c=c.trim().replace(ln,""),c.length<2)return"";for(;c.length%4!==0;)c=c+"=";return c}function gt(c,r){r=r||1/0;let i;const f=c.length;let p=null;const b=[];for(let I=0;I<f;++I){if(i=c.charCodeAt(I),i>55295&&i<57344){if(!p){if(i>56319){(r-=3)>-1&&b.push(239,191,189);continue}else if(I+1===f){(r-=3)>-1&&b.push(239,191,189);continue}p=i;continue}if(i<56320){(r-=3)>-1&&b.push(239,191,189),p=i;continue}i=(p-55296<<10|i-56320)+65536}else p&&(r-=3)>-1&&b.push(239,191,189);if(p=null,i<128){if((r-=1)<0)break;b.push(i)}else if(i<2048){if((r-=2)<0)break;b.push(i>>6|192,i&63|128)}else if(i<65536){if((r-=3)<0)break;b.push(i>>12|224,i>>6&63|128,i&63|128)}else if(i<1114112){if((r-=4)<0)break;b.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else throw new Error("Invalid code point")}return b}function fn(c){const r=[];for(let i=0;i<c.length;++i)r.push(c.charCodeAt(i)&255);return r}function hn(c,r){let i,f,p;const b=[];for(let I=0;I<c.length&&!((r-=2)<0);++I)i=c.charCodeAt(I),f=i>>8,p=i%256,b.push(p),b.push(f);return b}function Xt(c){return e.toByteArray(un(c))}function qe(c,r,i,f){let p;for(p=0;p<f&&!(p+i>=r.length||p>=c.length);++p)r[p+i]=c[p];return p}function re(c,r){return c instanceof r||c!=null&&c.constructor!=null&&c.constructor.name!=null&&c.constructor.name===r.name}function wt(c){return c!==c}const pn=function(){const c="0123456789abcdef",r=new Array(256);for(let i=0;i<16;++i){const f=i*16;for(let p=0;p<16;++p)r[f+p]=c[i]+c[p]}return r}();function ye(c){return typeof BigInt>"u"?yn:c}function yn(){throw new Error("BigInt not supported")}})(F);/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const ii={p:0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2fn,n:0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141n,b:7n,Gx:0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,Gy:0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n},{p:Ee,n:oe,Gx:oi,Gy:ai,b:Dr}=ii,J=32,Be=64,M=(t="")=>{throw new Error(t)},Rr=t=>typeof t=="bigint",_r=t=>typeof t=="string",si=t=>t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array",xe=(t,e)=>!si(t)||typeof e=="number"&&e>0&&t.length!==e?M("Uint8Array expected"):t,Ie=t=>new Uint8Array(t),ci=t=>Uint8Array.from(t),Pr=(t,e)=>t.toString(16).padStart(e,"0"),ft=t=>Array.from(xe(t)).map(e=>Pr(e,2)).join(""),ce={_0:48,_9:57,A:65,F:70,a:97,f:102},ir=t=>{if(t>=ce._0&&t<=ce._9)return t-ce._0;if(t>=ce.A&&t<=ce.F)return t-(ce.A-10);if(t>=ce.a&&t<=ce.f)return t-(ce.a-10)},Ot=t=>{const e="hex invalid";if(!_r(t))return M(e);const n=t.length,o=n/2;if(n%2)return M(e);const a=Ie(o);for(let l=0,u=0;l<o;l++,u+=2){const s=ir(t.charCodeAt(u)),h=ir(t.charCodeAt(u+1));if(s===void 0||h===void 0)return M(e);a[l]=s*16+h}return a},ee=(t,e)=>xe(_r(t)?Ot(t):ci(xe(t)),e),Nr=()=>globalThis?.crypto,li=()=>Nr()?.subtle??M("crypto.subtle must be defined"),Ae=(...t)=>{const e=Ie(t.reduce((o,a)=>o+xe(a).length,0));let n=0;return t.forEach(o=>{e.set(o,n),n+=o.length}),e},$t=(t=J)=>Nr().getRandomValues(Ie(t)),Fe=BigInt,$e=(t,e,n,o="bad number: out of range")=>Rr(t)&&e<=t&&t<n?t:M(o),k=(t,e=Ee)=>{const n=t%e;return n>=0n?n:e+n},Z=t=>k(t,oe),Me=(t,e)=>{(t===0n||e<=0n)&&M("no inverse n="+t+" mod="+e);let n=k(t,e),o=e,a=0n,l=1n;for(;n!==0n;){const u=o/n,s=o%n,h=a-l*u;o=n,n=s,a=l,l=h}return o===1n?k(a,e):M("no inverse")},or=t=>t instanceof j?t:M("Point expected"),Or=t=>k(k(t*t)*t+Dr),ar=t=>$e(t,0n,Ee),Ne=t=>$e(t,1n,Ee),Lt=t=>$e(t,1n,oe),Kt=t=>(t&1n)===0n,tt=t=>Uint8Array.of(t),$r=t=>tt(Kt(t)?2:3),ui=t=>{const e=Or(Ne(t));let n=1n;for(let o=e,a=(Ee+1n)/4n;a>0n;a>>=1n)a&1n&&(n=n*o%Ee),o=o*o%Ee;return k(n*n)===e?n:M("sqrt invalid")};class j{static BASE;static ZERO;px;py;pz;constructor(e,n,o){this.px=ar(e),this.py=Ne(n),this.pz=ar(o),Object.freeze(this)}static fromBytes(e){xe(e);let n;const o=e[0],a=e.subarray(1),l=rt(a,0,J),u=e.length;if(u===J+1&&[2,3].includes(o)){let s=ui(l);const h=Kt(s);Kt(Fe(o))!==h&&(s=k(-s)),n=new j(l,s,1n)}return u===Be+1&&o===4&&(n=new j(l,rt(a,J,Be),1n)),n?n.assertValidity():M("bad point: not on curve")}equals(e){const{px:n,py:o,pz:a}=this,{px:l,py:u,pz:s}=or(e),h=k(n*s),g=k(l*a),y=k(o*s),d=k(u*a);return h===g&&y===d}is0(){return this.equals(ve)}negate(){return new j(this.px,k(-this.py),this.pz)}double(){return this.add(this)}add(e){const{px:n,py:o,pz:a}=this,{px:l,py:u,pz:s}=or(e),h=0n,g=Dr;let y=0n,d=0n,v=0n;const w=k(g*3n);let E=k(n*l),B=k(o*u),A=k(a*s),S=k(n+o),m=k(l+u);S=k(S*m),m=k(E+B),S=k(S-m),m=k(n+a);let x=k(l+s);return m=k(m*x),x=k(E+A),m=k(m-x),x=k(o+a),y=k(u+s),x=k(x*y),y=k(B+A),x=k(x-y),v=k(h*m),y=k(w*A),v=k(y+v),y=k(B-v),v=k(B+v),d=k(y*v),B=k(E+E),B=k(B+E),A=k(h*A),m=k(w*m),B=k(B+A),A=k(E-A),A=k(h*A),m=k(m+A),E=k(B*m),d=k(d+E),E=k(x*m),y=k(S*y),y=k(y-E),E=k(S*B),v=k(x*v),v=k(v+E),new j(y,d,v)}multiply(e,n=!0){if(!n&&e===0n)return ve;if(Lt(e),e===1n)return this;if(this.equals(ie))return Si(e).p;let o=ve,a=ie;for(let l=this;e>0n;l=l.double(),e>>=1n)e&1n?o=o.add(l):n&&(a=a.add(l));return o}toAffine(){const{px:e,py:n,pz:o}=this;if(this.equals(ve))return{x:0n,y:0n};if(o===1n)return{x:e,y:n};const a=Me(o,Ee);return k(o*a)!==1n&&M("inverse invalid"),{x:k(e*a),y:k(n*a)}}assertValidity(){const{x:e,y:n}=this.toAffine();return Ne(e),Ne(n),k(n*n)===Or(e)?this:M("bad point: not on curve")}toBytes(e=!0){const{x:n,y:o}=this.assertValidity().toAffine(),a=ge(n);return e?Ae($r(o),a):Ae(tt(4),a,ge(o))}static fromAffine(e){const{x:n,y:o}=e;return n===0n&&o===0n?ve:new j(n,o,1n)}toHex(e){return ft(this.toBytes(e))}static fromPrivateKey(e){return ie.multiply(Ue(e))}static fromHex(e){return j.fromBytes(ee(e))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}toRawBytes(e){return this.toBytes(e)}}const ie=new j(oi,ai,1n),ve=new j(0n,1n,0n);j.BASE=ie;j.ZERO=ve;const Mr=(t,e,n)=>ie.multiply(e,!1).add(t.multiply(n,!1)).assertValidity(),He=t=>Fe("0x"+(ft(t)||"0")),rt=(t,e,n)=>He(t.subarray(e,n)),fi=2n**256n,ge=t=>Ot(Pr($e(t,0n,fi),Be)),Ue=t=>{const e=Rr(t)?t:He(ee(t,J));return $e(e,1n,oe,"private key invalid 3")},nt=t=>t>oe>>1n,hi=(t,e=!0)=>ie.multiply(Ue(t)).toBytes(e);class fe{r;s;recovery;constructor(e,n,o){this.r=Lt(e),this.s=Lt(n),o!=null&&(this.recovery=o),Object.freeze(this)}static fromBytes(e){xe(e,Be);const n=rt(e,0,J),o=rt(e,J,Be);return new fe(n,o)}toBytes(){const{r:e,s:n}=this;return Ae(ge(e),ge(n))}addRecoveryBit(e){return new fe(this.r,this.s,e)}hasHighS(){return nt(this.s)}toCompactRawBytes(){return this.toBytes()}toCompactHex(){return ft(this.toBytes())}recoverPublicKey(e){return mi(this,e)}static fromCompact(e){return fe.fromBytes(ee(e,Be))}assertValidity(){return this}normalizeS(){const{r:e,s:n,recovery:o}=this;return nt(n)?new fe(e,Z(-n),o):this}}const Hr=t=>{const e=t.length*8-256;e>1024&&M("msg invalid");const n=He(t);return e>0?n>>Fe(e):n},Mt=t=>Z(Hr(xe(t))),Vr={lowS:!0},pi={lowS:!0},yi=(t,e,n=Vr)=>{["der","recovered","canonical"].some(v=>v in n)&&M("option not supported");let{lowS:o,extraEntropy:a}=n;o==null&&(o=!0);const l=ge,u=Mt(ee(t)),s=l(u),h=Ue(e),g=[l(h),s];a&&g.push(a===!0?$t(J):ee(a));const y=u,d=v=>{const w=Hr(v);if(!(1n<=w&&w<oe))return;const E=ie.multiply(w).toAffine(),B=Z(E.x);if(B===0n)return;const A=Me(w,oe),S=Z(A*Z(y+Z(h*B)));if(S===0n)return;let m=S,x=(E.x===B?0:2)|Number(E.y&1n);return o&&nt(S)&&(m=Z(-S),x^=1),new fe(B,m,x)};return{seed:Ae(...g),k2sig:d}},di=t=>{let e=Ie(J),n=Ie(J),o=0;const a=Ie(0),l=()=>{e.fill(1),n.fill(0),o=0},u=1e3,s="drbg: tried 1000 values";{const h=(...d)=>Bi.hmacSha256Async(n,e,...d),g=async(d=a)=>{n=await h(tt(0),d),e=await h(),d.length!==0&&(n=await h(tt(1),d),e=await h())},y=async()=>(o++>=u&&M(s),e=await h(),e);return async(d,v)=>{l(),await g(d);let w;for(;!(w=v(await y()));)await g();return l(),w}}},gi=async(t,e,n=Vr)=>{const{seed:o,k2sig:a}=yi(t,e,n);return await di()(o,a)},wi=(t,e,n,o=pi)=>{let{lowS:a}=o;a==null&&(a=!0),"strict"in o&&M("option not supported");let l;const u=t&&typeof t=="object"&&"r"in t;!u&&ee(t).length!==Be&&M("signature must be 64 bytes");try{l=u?new fe(t.r,t.s):fe.fromCompact(t);const s=Mt(ee(e)),h=j.fromBytes(ee(n)),{r:g,s:y}=l;if(a&&nt(y))return!1;const d=Me(y,oe),v=Z(s*d),w=Z(g*d),E=Mr(h,v,w).toAffine();return Z(E.x)===g}catch{return!1}},mi=(t,e)=>{const{r:n,s:o,recovery:a}=t;[0,1,2,3].includes(a)||M("recovery id invalid");const l=Mt(ee(e,J)),u=a===2||a===3?n+oe:n;Ne(u);const s=$r(Fe(a)),h=Ae(s,ge(u)),g=j.fromBytes(h),y=Me(u,oe),d=Z(-l*y),v=Z(o*y);return Mr(g,d,v)},bi=(t,e,n=!0)=>j.fromBytes(ee(e)).multiply(Ue(t)).toBytes(n),jr=t=>{t=ee(t),(t.length<J+8||t.length>1024)&&M("expected 40-1024b");const e=k(He(t),oe-1n);return ge(e+1n)},vi=()=>jr($t(J+16)),Ei="SHA-256",Bi={hexToBytes:Ot,bytesToHex:ft,concatBytes:Ae,bytesToNumberBE:He,numberToBytesBE:ge,mod:k,invert:Me,hmacSha256Async:async(t,...e)=>{const n=li(),o="HMAC",a=await n.importKey("raw",t,{name:o,hash:{name:Ei}},!1,["sign"]);return Ie(await n.sign(o,a,Ae(...e)))},hmacSha256Sync:void 0,hashToPrivateKey:jr,randomBytes:$t},Ii={normPrivateKeyToScalar:Ue,isValidPrivateKey:t=>{try{return!!Ue(t)}catch{return!1}},randomPrivateKey:vi,precompute:(t=8,e=ie)=>(e.multiply(3n),e)},it=8,xi=256,zr=Math.ceil(xi/it)+1,Tt=2**(it-1),Ai=()=>{const t=[];let e=ie,n=e;for(let o=0;o<zr;o++){n=e,t.push(n);for(let a=1;a<Tt;a++)n=n.add(e),t.push(n);e=n.double()}return t};let sr;const cr=(t,e)=>{const n=e.negate();return t?n:e},Si=t=>{const e=sr||(sr=Ai());let n=ve,o=ie;const a=2**it,l=a,u=Fe(a-1),s=Fe(it);for(let h=0;h<zr;h++){let g=Number(t&u);t>>=s,g>Tt&&(g-=l,t+=1n);const y=h*Tt,d=y,v=y+Math.abs(g)-1,w=h%2!==0,E=g<0;g===0?o=o.add(cr(w,e[d])):n=n.add(cr(E,e[v]))}return{p:n,f:o}};var qr={exports:{}};function ki(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var vt={exports:{}};const Li={},Ki=Object.freeze(Object.defineProperty({__proto__:null,default:Li},Symbol.toStringTag,{value:"Module"})),Ti=Wn(Ki);var lr;function Yr(){return lr||(lr=1,function(t,e){(function(n,o){t.exports=o()})(Ce,function(){var n=n||function(o,a){var l;if(typeof window<"u"&&window.crypto&&(l=window.crypto),typeof self<"u"&&self.crypto&&(l=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(l=globalThis.crypto),!l&&typeof window<"u"&&window.msCrypto&&(l=window.msCrypto),!l&&typeof Ce<"u"&&Ce.crypto&&(l=Ce.crypto),!l&&typeof ki=="function")try{l=Ti}catch{}var u=function(){if(l){if(typeof l.getRandomValues=="function")try{return l.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof l.randomBytes=="function")try{return l.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function m(){}return function(x){var L;return m.prototype=x,L=new m,m.prototype=null,L}}(),h={},g=h.lib={},y=g.Base=function(){return{extend:function(m){var x=s(this);return m&&x.mixIn(m),(!x.hasOwnProperty("init")||this.init===x.init)&&(x.init=function(){x.$super.init.apply(this,arguments)}),x.init.prototype=x,x.$super=this,x},create:function(){var m=this.extend();return m.init.apply(m,arguments),m},init:function(){},mixIn:function(m){for(var x in m)m.hasOwnProperty(x)&&(this[x]=m[x]);m.hasOwnProperty("toString")&&(this.toString=m.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=g.WordArray=y.extend({init:function(m,x){m=this.words=m||[],x!=a?this.sigBytes=x:this.sigBytes=m.length*4},toString:function(m){return(m||w).stringify(this)},concat:function(m){var x=this.words,L=m.words,K=this.sigBytes,U=m.sigBytes;if(this.clamp(),K%4)for(var D=0;D<U;D++){var $=L[D>>>2]>>>24-D%4*8&255;x[K+D>>>2]|=$<<24-(K+D)%4*8}else for(var H=0;H<U;H+=4)x[K+H>>>2]=L[H>>>2];return this.sigBytes+=U,this},clamp:function(){var m=this.words,x=this.sigBytes;m[x>>>2]&=4294967295<<32-x%4*8,m.length=o.ceil(x/4)},clone:function(){var m=y.clone.call(this);return m.words=this.words.slice(0),m},random:function(m){for(var x=[],L=0;L<m;L+=4)x.push(u());return new d.init(x,m)}}),v=h.enc={},w=v.Hex={stringify:function(m){for(var x=m.words,L=m.sigBytes,K=[],U=0;U<L;U++){var D=x[U>>>2]>>>24-U%4*8&255;K.push((D>>>4).toString(16)),K.push((D&15).toString(16))}return K.join("")},parse:function(m){for(var x=m.length,L=[],K=0;K<x;K+=2)L[K>>>3]|=parseInt(m.substr(K,2),16)<<24-K%8*4;return new d.init(L,x/2)}},E=v.Latin1={stringify:function(m){for(var x=m.words,L=m.sigBytes,K=[],U=0;U<L;U++){var D=x[U>>>2]>>>24-U%4*8&255;K.push(String.fromCharCode(D))}return K.join("")},parse:function(m){for(var x=m.length,L=[],K=0;K<x;K++)L[K>>>2]|=(m.charCodeAt(K)&255)<<24-K%4*8;return new d.init(L,x)}},B=v.Utf8={stringify:function(m){try{return decodeURIComponent(escape(E.stringify(m)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(m){return E.parse(unescape(encodeURIComponent(m)))}},A=g.BufferedBlockAlgorithm=y.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(m){typeof m=="string"&&(m=B.parse(m)),this._data.concat(m),this._nDataBytes+=m.sigBytes},_process:function(m){var x,L=this._data,K=L.words,U=L.sigBytes,D=this.blockSize,$=D*4,H=U/$;m?H=o.ceil(H):H=o.max((H|0)-this._minBufferSize,0);var pe=H*D,te=o.min(pe*4,U);if(pe){for(var me=0;me<pe;me+=D)this._doProcessBlock(K,me);x=K.splice(0,pe),L.sigBytes-=te}return new d.init(x,te)},clone:function(){var m=y.clone.call(this);return m._data=this._data.clone(),m},_minBufferSize:0});g.Hasher=A.extend({cfg:y.extend(),init:function(m){this.cfg=this.cfg.extend(m),this.reset()},reset:function(){A.reset.call(this),this._doReset()},update:function(m){return this._append(m),this._process(),this},finalize:function(m){m&&this._append(m);var x=this._doFinalize();return x},blockSize:16,_createHelper:function(m){return function(x,L){return new m.init(L).finalize(x)}},_createHmacHelper:function(m){return function(x,L){return new S.HMAC.init(m,L).finalize(x)}}});var S=h.algo={};return h}(Math);return n})}(vt)),vt.exports}(function(t,e){(function(n,o){t.exports=o(Yr())})(Ce,function(n){return function(o){var a=n,l=a.lib,u=l.WordArray,s=l.Hasher,h=a.algo,g=[],y=[];(function(){function w(S){for(var m=o.sqrt(S),x=2;x<=m;x++)if(!(S%x))return!1;return!0}function E(S){return(S-(S|0))*4294967296|0}for(var B=2,A=0;A<64;)w(B)&&(A<8&&(g[A]=E(o.pow(B,1/2))),y[A]=E(o.pow(B,1/3)),A++),B++})();var d=[],v=h.SHA256=s.extend({_doReset:function(){this._hash=new u.init(g.slice(0))},_doProcessBlock:function(w,E){for(var B=this._hash.words,A=B[0],S=B[1],m=B[2],x=B[3],L=B[4],K=B[5],U=B[6],D=B[7],$=0;$<64;$++){if($<16)d[$]=w[E+$]|0;else{var H=d[$-15],pe=(H<<25|H>>>7)^(H<<14|H>>>18)^H>>>3,te=d[$-2],me=(te<<15|te>>>17)^(te<<13|te>>>19)^te>>>10;d[$]=pe+d[$-7]+me+d[$-16]}var ht=L&K^~L&U,Ve=A&S^A&m^S&m,je=(A<<30|A>>>2)^(A<<19|A>>>13)^(A<<10|A>>>22),pt=(L<<26|L>>>6)^(L<<21|L>>>11)^(L<<7|L>>>25),ze=D+pt+ht+y[$]+d[$],yt=je+Ve;D=U,U=K,K=L,L=x+ze|0,x=m,m=S,S=A,A=ze+yt|0}B[0]=B[0]+A|0,B[1]=B[1]+S|0,B[2]=B[2]+m|0,B[3]=B[3]+x|0,B[4]=B[4]+L|0,B[5]=B[5]+K|0,B[6]=B[6]+U|0,B[7]=B[7]+D|0},_doFinalize:function(){var w=this._data,E=w.words,B=this._nDataBytes*8,A=w.sigBytes*8;return E[A>>>5]|=128<<24-A%32,E[(A+64>>>9<<4)+14]=o.floor(B/4294967296),E[(A+64>>>9<<4)+15]=B,w.sigBytes=E.length*4,this._process(),this._hash},clone:function(){var w=s.clone.call(this);return w._hash=this._hash.clone(),w}});a.SHA256=s._createHelper(v),a.HmacSHA256=s._createHmacHelper(v)}(Math),n.SHA256})})(qr);var Ci=qr.exports;const Fi=Fr(Ci);var Jr={exports:{}};(function(t,e){(function(n,o){t.exports=o(Yr())})(Ce,function(n){return function(){var o=n,a=o.lib,l=a.WordArray,u=o.enc;u.Base64={stringify:function(h){var g=h.words,y=h.sigBytes,d=this._map;h.clamp();for(var v=[],w=0;w<y;w+=3)for(var E=g[w>>>2]>>>24-w%4*8&255,B=g[w+1>>>2]>>>24-(w+1)%4*8&255,A=g[w+2>>>2]>>>24-(w+2)%4*8&255,S=E<<16|B<<8|A,m=0;m<4&&w+m*.75<y;m++)v.push(d.charAt(S>>>6*(3-m)&63));var x=d.charAt(64);if(x)for(;v.length%4;)v.push(x);return v.join("")},parse:function(h){var g=h.length,y=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var v=0;v<y.length;v++)d[y.charCodeAt(v)]=v}var w=y.charAt(64);if(w){var E=h.indexOf(w);E!==-1&&(g=E)}return s(h,g,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function s(h,g,y){for(var d=[],v=0,w=0;w<g;w++)if(w%4){var E=y[h.charCodeAt(w-1)]<<w%4*2,B=y[h.charCodeAt(w)]>>>6-w%4*2,A=E|B;d[v>>>2]|=A<<24-v%4*8,v++}return l.create(d,v)}}(),n.enc.Base64})})(Jr);var Ui=Jr.exports;const ur=Fr(Ui);function Wr(){return{s:[[-785314906,-1730169428,805139163,-803545161,-1193168915,1780907670,-1166241723,-248741991,614570311,-1282315017,134345442,-2054226922,1667834072,1901547113,-1537671517,-191677058,227898511,1921955416,1904987480,-2112533778,2069144605,-1034266187,-1674521287,720527379,-976113629,677414384,-901678824,-1193592593,-1904616272,1614419982,1822297739,-1340175810,-686458943,-1120842969,2024746970,1432378464,-430627341,-1437226092,1464375394,1676153920,1439316330,715854006,-1261675468,289532110,-1588296017,2087905683,-1276242927,1668267050,732546397,1947742710,-832815594,-1685613794,-1344882125,1814351708,2050118529,680887927,999245976,1800124847,-994056165,1713906067,1641548236,-81679983,1216130144,1575780402,-276538019,-377129551,-601480446,-345695352,596196993,-745100091,258830323,-2081144263,772490370,-1534844924,1774776394,-1642095778,566650946,-152474470,1728879713,-1412200208,1783734482,-665571480,-1777359064,-1420741725,1861159788,326777828,-1170476976,2130389656,-1578015459,967770486,1724537150,-2109534584,-1930525159,1164943284,2105845187,998989502,-529566248,-2050940813,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,-804646328,-619713837,1240580251,122909385,-2137449605,634681816,-152510729,-469872614,-1233564613,-1754472259,79693498,-1045868618,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,-1691314900,-863943356,-1352745719,-1092366332,-567063811,1712269319,422464435,-1060394921,1170764815,-771006663,-1177289765,1434042557,442511882,-694091578,1076654713,1738483198,-81812532,-1901729288,-617471240,1014306527,-43947243,793779912,-1392160085,842905082,-48003232,1395751752,1040244610,-1638115397,-898659168,445077038,-552113701,-717051658,679411651,-1402522938,-1940957837,1767581616,-1144366904,-503340195,-1192226400,284835224,-48135240,1258075500,768725851,-1705778055,-1225243291,-762426948,1274779536,-505548070,-1530167757,1660621633,-823867672,-283063590,913787905,-797008130,737222580,-1780753843,-1366257256,-357724559,1804850592,-795946544,-1345903136,-1908647121,-1904896841,-1879645445,-233690268,-2004305902,-1878134756,1336762016,1754252060,-774901359,-1280786003,791618072,-1106372745,-361419266,-1962795103,-442446833,-1250986776,413987798,-829824359,-1264037920,-49028937,2093235073,-760370983,375366246,-2137688315,-1815317740,555357303,-424861595,2008414854,-950779147,-73583153,-338841844,2067696032,-700376109,-1373733303,2428461,544322398,577241275,1471733935,610547355,-267798242,1432588573,1507829418,2025931657,-648391809,545086370,48609733,-2094660746,1653985193,298326376,1316178497,-1287180854,2064951626,458293330,-1705826027,-703637697,-1130641692,727753846,-2115603456,146436021,1461446943,-224990101,705550613,-1235000031,-407242314,-13368018,-981117340,1404054877,-1449160799,146425753,1854211946],[1266315497,-1246549692,-613086930,-1004984797,-1385257296,1235738493,-1662099272,-1880247706,-324367247,1771706367,1449415276,-1028546847,422970021,1963543593,-1604775104,-468174274,1062508698,1531092325,1804592342,-1711849514,-1580033017,-269995787,1294809318,-265986623,1289560198,-2072974554,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,-1214491899,-1437595849,1040679964,2145300060,-1904392980,1461121720,-1338320329,-263189491,-266592508,33600511,-1374882534,1018524850,629373528,-603381315,-779021319,2091462646,-1808644237,586499841,988145025,935516892,-927631820,-1695294041,-1455136442,265290510,-322386114,-1535828415,-499593831,1005194799,847297441,406762289,1314163512,1332590856,1866599683,-167115585,750260880,613907577,1450815602,-1129346641,-560302305,-644675568,-1282691566,-590397650,1427272223,778793252,1343938022,-1618686585,2052605720,1946737175,-1130390852,-380928628,-327488454,-612033030,1661551462,-1000029230,-283371449,840292616,-582796489,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,-2119403562,1594956187,70604529,-677132437,1007753275,1495573769,-225450259,-1745748998,-1631928532,504708206,-2031925904,-353800271,-2045878774,1514023603,1998579484,1312622330,694541497,-1712906993,-2143385130,1382467621,776784248,-1676627094,-971698502,-1797068168,-1510196141,503983604,-218673497,907881277,423175695,432175456,1378068232,-149744970,-340918674,-356311194,-474200683,-1501837181,-1317062703,26017576,-1020076561,-1100195163,1700274565,1756076034,-288447217,-617638597,720338349,1533947780,354530856,688349552,-321042571,1637815568,332179504,-345916010,53804574,-1442618417,-1250730864,1282449977,-711025141,-877994476,-288586052,1617046695,-1666491221,-1292663698,1686838959,431878346,-1608291911,1700445008,1080580658,1009431731,832498133,-1071531785,-1688990951,-2023776103,-1778935426,1648197032,-130578278,-1746719369,300782431,375919233,238389289,-941219882,-1763778655,2019080857,1475708069,455242339,-1685863425,448939670,-843904277,1395535956,-1881585436,1841049896,1491858159,885456874,-30872223,-293847949,1565136089,-396052509,1108368660,540939232,1173283510,-1549095958,-613658859,-87339056,-951913406,-278217803,1699691293,1103962373,-669091426,-2038084153,-464828566,1031889488,-815619598,1535977030,-58162272,-1043876189,2132092099,1774941330,1199868427,1452454533,157007616,-1390851939,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,-1919713727,-698356495,1814182875,2094937945,-873565088,1082520231,-831049106,-1509457788,435703966,-386934699,1641649973,-1452693590,-989067582,1510255612,-2146710820,-1639679442,-1018874748,-36346107,236887753,-613164077,274041037,1734335097,-479771840,-976997275,1899903192,1026095262,-244449504,356393447,-1884275382,-421290197,-612127241],[-381855128,-1803468553,-162781668,-1805047500,1091903735,1979897079,-1124832466,-727580568,-737663887,857797738,1136121015,1342202287,507115054,-1759230650,337727348,-1081374656,1301675037,-1766485585,1895095763,1721773893,-1078195732,62756741,2142006736,835421444,-1762973773,1442658625,-635090970,-1412822374,676362277,1392781812,170690266,-373920261,1759253602,-683120384,1745797284,664899054,1329594018,-393761396,-1249058810,2062866102,-1429332356,-751345684,-830954599,1080764994,553557557,-638351943,-298199125,991055499,499776247,1265440854,648242737,-354183246,980351604,-581221582,1749149687,-898096901,-83167922,-654396521,1161844396,-1169648345,1431517754,545492359,-26498633,-795437749,1437099964,-1592419752,-861329053,-1713251533,-1507177898,1060185593,1593081372,-1876348548,-34019326,69676912,-2135222948,86519011,-1782508216,-456757982,1220612927,-955283748,133810670,1090789135,1078426020,1569222167,845107691,-711212847,-222510705,1091646820,628848692,1613405280,-537335645,526609435,236106946,48312990,-1352249391,-892239595,1797494240,859738849,992217954,-289490654,-2051890674,-424014439,-562951028,765654824,-804095931,-1783130883,1685915746,-405998096,1414112111,-2021832454,-1013056217,-214004450,172450625,-1724973196,980381355,-185008841,-1475158944,-1578377736,-1726226100,-613520627,-964995824,1835478071,660984891,-590288892,-248967737,-872349789,-1254551662,1762651403,1719377915,-824476260,-1601057013,-652910941,-1156370552,1364962596,2073328063,1983633131,926494387,-871278215,-2144935273,-198299347,1749200295,-966120645,309677260,2016342300,1779581495,-1215147545,111262694,1274766160,443224088,298511866,1025883608,-488520759,1145181785,168956806,-653464466,-710153686,1689216846,-628709281,-1094719096,1692713982,-1648590761,-252198778,1618508792,1610833997,-771914938,-164094032,2001055236,-684262196,-2092799181,-266425487,-1333771897,1006657119,2006996926,-1108824540,1430667929,-1084739999,1314452623,-220332638,-193663176,-2021016126,1399257539,-927756684,-1267338667,1190975929,2062231137,-1960976508,-2073424263,-1856006686,1181637006,548689776,-1932175983,-922558900,-1190417183,-1149106736,296247880,1970579870,-1216407114,-525738999,1714227617,-1003338189,-396747006,166772364,1251581989,493813264,448347421,195405023,-1584991729,677966185,-591930749,1463355134,-1578971493,1338867538,1343315457,-1492745222,-1610435132,233230375,-1694987225,2000651841,-1017099258,1638401717,-266896856,-1057650976,6314154,819756386,300326615,590932579,1405279636,-1027467724,-1144263082,-1866680610,-335774303,-833020554,1862657033,1266418056,963775037,2089974820,-2031914401,1917689273,448879540,-744572676,-313240200,150775221,-667058989,1303187396,508620638,-1318983944,-1568336679,1817252668,1876281319,1457606340,908771278,-574175177,-677760460,-1838972398,1729034894,1080033504],[976866871,-738527793,-1413318857,1522871579,1555064734,1336096578,-746444992,-1715692610,-720269667,-1089506539,-701686658,-956251013,-1215554709,564236357,-1301368386,1781952180,1464380207,-1131123079,-962365742,1699332808,1393555694,1183702653,-713881059,1288719814,691649499,-1447410096,-1399511320,-1101077756,-1577396752,1781354906,1676643554,-1702433246,-1064713544,1126444790,-1524759638,-1661808476,-2084544070,-1679201715,-1880812208,-1167828010,673620729,-1489356063,1269405062,-279616791,-953159725,-145557542,1057255273,2012875353,-2132498155,-2018474495,-1693849939,993977747,-376373926,-1640704105,753973209,36408145,-1764381638,25011837,-774947114,2088578344,530523599,-1376601957,1524020338,1518925132,-534139791,-535190042,1202760957,-309069157,-388774771,674977740,-120232407,2031300136,2019492241,-311074731,-141160892,-472686964,352677332,-1997247046,60907813,90501309,-1007968747,1016092578,-1759044884,-1455814870,457141659,509813237,-174299397,652014361,1966332200,-1319764491,55981186,-1967506245,676427537,-1039476232,-1412673177,-861040033,1307055953,942726286,933058658,-1826555503,-361066302,-79791154,1361170020,2001714738,-1464409218,-1020707514,1222529897,1679025792,-1565652976,-580013532,1770335741,151462246,-1281735158,1682292957,1483529935,471910574,1539241949,458788160,-858652289,1807016891,-576558466,978976581,1043663428,-1129001515,1927990952,-94075717,-1922690386,-1086558393,-761535389,1412390302,-1362987237,-162634896,1947078029,-413461673,-126740879,-1353482915,1077988104,1320477388,886195818,18198404,-508558296,-1785185763,112762804,-831610808,1866414978,891333506,18488651,661792760,1628790961,-409780260,-1153795797,876946877,-1601685023,1372485963,791857591,-1608533303,-534984578,-1127755274,-822013501,-1578587449,445679433,-732971622,-790962485,-720709064,54117162,-963561881,-1913048708,-525259953,-140617289,1140177722,-220915201,668550556,-1080614356,367459370,261225585,-1684794075,-85617823,-826893077,-1029151655,314222801,-1228863650,-486184436,282218597,-888953790,-521376242,379116347,1285071038,846784868,-1625320142,-523005217,-744475605,-1989021154,453669953,1268987020,-977374944,-1015663912,-550133875,-1684459730,-435458233,266596637,-447948204,517658769,-832407089,-851542417,370717030,-47440635,-2070949179,-151313767,-182193321,-1506642397,-1817692879,1456262402,-1393524382,1517677493,1846949527,-1999473716,-560569710,-2118563376,1280348187,1908823572,-423180355,846861322,1172426758,-1007518822,-911584259,1655181056,-1155153950,901632758,1897031941,-1308360158,-1228157060,-847864789,1393639104,373351379,950779232,625454576,-1170726756,-146354570,2007998917,544563296,-2050228658,-1964470824,2058025392,1291430526,424198748,50039436,29584100,-689184263,-1865090967,-1503863136,1057563949,-1039604065,-1219600078,-831004069,1469046755,985887462]],p:[608135816,-2052912941,320440878,57701188,-1542899678,698298832,137296536,-330404727,1160258022,953160567,-1101764913,887688300,-1062458953,-914599715,1065670069,-1253635817,-1843997223,-1988494565]}}var Ct=function(t){this.b=t,this.o=0};Ct.prototype.readInt32BE=function(){var t;if(this.b.length==0)return 0;if(this.o+4<=this.b.length)t=this.b.readInt32BE(this.o);else{let e=F.Buffer.alloc(4);for(let n=0;n<4;n++)e[n]=this.b[(this.o+n)%this.b.length];t=e.readInt32BE(0)}return this.o=(this.o+4)%this.b.length,t};function Gr(t,e,n){var o,a,l;if(typeof e=="string"&&(e=F.Buffer.from(e,"utf8")),!F.Buffer.isBuffer(e))throw new Error("Bad key");if(n){if(typeof n=="string"&&(n=F.Buffer.from(n,"utf8")),!F.Buffer.isBuffer(n))throw new Error("Bad salt")}else n=void 0;o=new Ct(e);for(let u=0;u<t.p.length;u++)t.p[u]^=o.readInt32BE();[a,l]=[0,0],o=n?new Ct(n):void 0;for(let u=0;u<t.p.length;u+=2)o&&(a^=o.readInt32BE(),l^=o.readInt32BE()),[a,l]=we(t,a,l),t.p[u]=a,t.p[u+1]=l;for(let u=0;u<t.s.length;u++)for(let s=0;s<t.s[u].length;s+=2)o&&(a^=o.readInt32BE(),l^=o.readInt32BE()),[a,l]=we(t,a,l),t.s[u][s]=a,t.s[u][s+1]=l;return t}function Di(t,e){var n=Wr();return Gr(n,t,e)}function ot(t,e,n){return(((t.s[0][e>>>24&255]+t.s[1][e>>>16&255]|0)^t.s[2][e>>>8&255])+t.s[3][e&255]|0)^t.p[n]}function we(t,e,n){e^=t.p[0],n|=0;for(let o=1;o<=15;o+=2)n^=ot(t,e,o),e^=ot(t,n,o+1);return[n^t.p[17],e]}function Ht(t,e,n){e^=t.p[17],n|=0;for(let o=16;o>=2;o-=2)n^=ot(t,e,o),e^=ot(t,n,o-1);return[n^t.p[0],e]}function Ri(t,e,n){if(!(F.Buffer.isBuffer(e)&&e.length%8==0))throw new RangeError("Invalid input block");var o=F.Buffer.alloc(e.length),a=n?Ht:we;for(let l=0;l<e.length;l+=8){let u=e.readInt32BE(l),s=e.readInt32BE(l+4);[u,s]=a(t,u,s),o.writeInt32BE(u,l),o.writeInt32BE(s,l+4)}return o}function _i(t,e,n,o){if(!(F.Buffer.isBuffer(e)&&e.length==8))throw new RangeError("Invalid initialization vector");if(!(F.Buffer.isBuffer(n)&&n.length%8==0))throw new RangeError("Invalid input block");var a=F.Buffer.alloc(n.length);if(o){let l=e.readInt32BE(0),u=e.readInt32BE(4);for(let s=0;s<n.length;s+=8){let h=n.readInt32BE(s),g=n.readInt32BE(s+4),y,d;[y,d]=Ht(t,h,g),y^=l,d^=u,a.writeInt32BE(y,s),a.writeInt32BE(d,s+4),l=h,u=g}}else{let l=e.readInt32BE(0),u=e.readInt32BE(4);for(let s=0;s<n.length;s+=8)l=n.readInt32BE(s)^l,u=n.readInt32BE(s+4)^u,[l,u]=we(t,l,u),a.writeInt32BE(l,s),a.writeInt32BE(u,s+4)}return a}function Pi(t,e,n,o){if(!(F.Buffer.isBuffer(e)&&e.length==8))throw new RangeError("Invalid initialization vector");if(!F.Buffer.isBuffer(n))throw new RangeError("Invalid input block");var a;n.length%8==0?a=F.Buffer.from(n):(a=F.Buffer.alloc(n.length+(8-n.length%8)),n.copy(a));var l=e.readInt32BE(0),u=e.readInt32BE(4);if(o)for(let s=0;s<a.length;s+=8){let h=a.readInt32BE(s),g=a.readInt32BE(s+4);[l,u]=we(t,l,u),l^=h,u^=g,a.writeInt32BE(l,s),a.writeInt32BE(u,s+4),l=h,u=g}else for(let s=0;s<a.length;s+=8)[l,u]=we(t,l,u),l^=a.readInt32BE(s),u^=a.readInt32BE(s+4),a.writeInt32BE(l,s),a.writeInt32BE(u,s+4);return a.length>n.length&&(a=a.slice(0,n.length)),a}function Ni(t,e,n){if(!(F.Buffer.isBuffer(e)&&e.length==8))throw new RangeError("Invalid initialization vector");if(!F.Buffer.isBuffer(n))throw new RangeError("Invalid input block");var o;n.length%8==0?o=F.Buffer.from(n):(o=F.Buffer.alloc(n.length+(8-n.length%8)),n.copy(o));var a=e.readInt32BE(0),l=e.readInt32BE(4);for(let u=0;u<o.length;u+=8){[a,l]=we(t,a,l);let s=a^o.readInt32BE(u),h=l^o.readInt32BE(u+4);o.writeInt32BE(s,u),o.writeInt32BE(h,u+4)}return o.length>n.length&&(o=o.slice(0,n.length)),o}const fr={allocState:Wr,expandState:Gr,key:Di,encipherBlock:we,decipherBlock:Ht,ecb:Ri,cbc:_i,cfb:Pi,ofb:Ni},Xr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zr="ARRAYBUFFER not supported by this environment",Qr="UINT8ARRAY not supported by this environment";function hr(t,e,n,o){let a,l,u;const s=e||[0],h=(n=n||0)>>>3,g=o===-1?3:0;for(a=0;a<t.length;a+=1)u=a+h,l=u>>>2,s.length<=l&&s.push(0),s[l]|=t[a]<<8*(g+o*(u%4));return{value:s,binLen:8*t.length+n}}function Vt(t,e,n){switch(e){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(t){case"HEX":return function(o,a,l){return function(u,s,h,g){let y,d,v,w;if(u.length%2!=0)throw new Error("String of HEX type must be in byte increments");const E=s||[0],B=(h=h||0)>>>3,A=g===-1?3:0;for(y=0;y<u.length;y+=2){if(d=parseInt(u.substr(y,2),16),isNaN(d))throw new Error("String of HEX type contains invalid characters");for(w=(y>>>1)+B,v=w>>>2;E.length<=v;)E.push(0);E[v]|=d<<8*(A+g*(w%4))}return{value:E,binLen:4*u.length+h}}(o,a,l,n)};case"TEXT":return function(o,a,l){return function(u,s,h,g,y){let d,v,w,E,B,A,S,m,x=0;const L=h||[0],K=(g=g||0)>>>3;if(s==="UTF8")for(S=y===-1?3:0,w=0;w<u.length;w+=1)for(d=u.charCodeAt(w),v=[],128>d?v.push(d):2048>d?(v.push(192|d>>>6),v.push(128|63&d)):55296>d||57344<=d?v.push(224|d>>>12,128|d>>>6&63,128|63&d):(w+=1,d=65536+((1023&d)<<10|1023&u.charCodeAt(w)),v.push(240|d>>>18,128|d>>>12&63,128|d>>>6&63,128|63&d)),E=0;E<v.length;E+=1){for(A=x+K,B=A>>>2;L.length<=B;)L.push(0);L[B]|=v[E]<<8*(S+y*(A%4)),x+=1}else for(S=y===-1?2:0,m=s==="UTF16LE"&&y!==1||s!=="UTF16LE"&&y===1,w=0;w<u.length;w+=1){for(d=u.charCodeAt(w),m===!0&&(E=255&d,d=E<<8|d>>>8),A=x+K,B=A>>>2;L.length<=B;)L.push(0);L[B]|=d<<8*(S+y*(A%4)),x+=2}return{value:L,binLen:8*x+g}}(o,e,a,l,n)};case"B64":return function(o,a,l){return function(u,s,h,g){let y,d,v,w,E,B,A,S=0;const m=s||[0],x=(h=h||0)>>>3,L=g===-1?3:0,K=u.indexOf("=");if(u.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(u=u.replace(/=/g,""),K!==-1&&K<u.length)throw new Error("Invalid '=' found in base-64 string");for(d=0;d<u.length;d+=4){for(E=u.substr(d,4),w=0,v=0;v<E.length;v+=1)y=Xr.indexOf(E.charAt(v)),w|=y<<18-6*v;for(v=0;v<E.length-1;v+=1){for(A=S+x,B=A>>>2;m.length<=B;)m.push(0);m[B]|=(w>>>16-8*v&255)<<8*(L+g*(A%4)),S+=1}}return{value:m,binLen:8*S+h}}(o,a,l,n)};case"BYTES":return function(o,a,l){return function(u,s,h,g){let y,d,v,w;const E=s||[0],B=(h=h||0)>>>3,A=g===-1?3:0;for(d=0;d<u.length;d+=1)y=u.charCodeAt(d),w=d+B,v=w>>>2,E.length<=v&&E.push(0),E[v]|=y<<8*(A+g*(w%4));return{value:E,binLen:8*u.length+h}}(o,a,l,n)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(Zr)}return function(o,a,l){return function(u,s,h,g){return hr(new Uint8Array(u),s,h,g)}(o,a,l,n)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(Qr)}return function(o,a,l){return hr(o,a,l,n)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function pr(t,e,n,o){switch(t){case"HEX":return function(a){return function(l,u,s,h){const g="0123456789abcdef";let y,d,v="";const w=u/8,E=s===-1?3:0;for(y=0;y<w;y+=1)d=l[y>>>2]>>>8*(E+s*(y%4)),v+=g.charAt(d>>>4&15)+g.charAt(15&d);return h.outputUpper?v.toUpperCase():v}(a,e,n,o)};case"B64":return function(a){return function(l,u,s,h){let g,y,d,v,w,E="";const B=u/8,A=s===-1?3:0;for(g=0;g<B;g+=3)for(v=g+1<B?l[g+1>>>2]:0,w=g+2<B?l[g+2>>>2]:0,d=(l[g>>>2]>>>8*(A+s*(g%4))&255)<<16|(v>>>8*(A+s*((g+1)%4))&255)<<8|w>>>8*(A+s*((g+2)%4))&255,y=0;y<4;y+=1)E+=8*g+6*y<=u?Xr.charAt(d>>>6*(3-y)&63):h.b64Pad;return E}(a,e,n,o)};case"BYTES":return function(a){return function(l,u,s){let h,g,y="";const d=u/8,v=s===-1?3:0;for(h=0;h<d;h+=1)g=l[h>>>2]>>>8*(v+s*(h%4))&255,y+=String.fromCharCode(g);return y}(a,e,n)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(Zr)}return function(a){return function(l,u,s){let h;const g=u/8,y=new ArrayBuffer(g),d=new Uint8Array(y),v=s===-1?3:0;for(h=0;h<g;h+=1)d[h]=l[h>>>2]>>>8*(v+s*(h%4))&255;return y}(a,e,n)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(Qr)}return function(a){return function(l,u,s){let h;const g=u/8,y=s===-1?3:0,d=new Uint8Array(g);for(h=0;h<g;h+=1)d[h]=l[h>>>2]>>>8*(y+s*(h%4))&255;return d}(a,e,n)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const en=4294967296,tn="Cannot set numRounds with MAC";function at(t,e){let n,o;const a=t.binLen>>>3,l=e.binLen>>>3,u=a<<3,s=4-a<<3;if(a%4!=0){for(n=0;n<l;n+=4)o=a+n>>>2,t.value[o]|=e.value[n>>>2]<<u,t.value.push(0),t.value[o+1]|=e.value[n>>>2]>>>s;return(t.value.length<<2)-4>=l+a&&t.value.pop(),{value:t.value,binLen:t.binLen+e.binLen}}return{value:t.value.concat(e.value),binLen:t.binLen+e.binLen}}function yr(t){const e={outputUpper:!1,b64Pad:"=",outputLen:-1},n=t||{},o="Output length must be a multiple of 8";if(e.outputUpper=n.outputUpper||!1,n.b64Pad&&(e.b64Pad=n.b64Pad),n.outputLen){if(n.outputLen%8!=0)throw new Error(o);e.outputLen=n.outputLen}else if(n.shakeLen){if(n.shakeLen%8!=0)throw new Error(o);e.outputLen=n.shakeLen}if(typeof e.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof e.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return e}function _e(t,e,n,o){const a=t+" must include a value and format";if(!e){if(!o)throw new Error(a);return o}if(e.value===void 0||!e.format)throw new Error(a);return Vt(e.format,e.encoding||"UTF8",n)(e.value)}class Oi{constructor(e,n,o){const a=o||{};if(this.t=n,this.i=a.encoding||"UTF8",this.numRounds=a.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=e,this.h=[],this.u=0,this.l=!1,this.A=0,this.p=!1,this.m=[],this.U=[]}update(e){let n,o=0;const a=this.R>>>5,l=this.C(e,this.h,this.u),u=l.binLen,s=l.value,h=u>>>5;for(n=0;n<h;n+=a)o+this.R<=u&&(this.v=this.H(s.slice(n,n+a),this.v),o+=this.R);return this.A+=o,this.h=s.slice(o>>>5),this.u=u%this.R,this.l=!0,this}getHash(e,n){let o,a,l=this.T;const u=yr(n);if(this.F){if(u.outputLen===-1)throw new Error("Output length must be specified in options");l=u.outputLen}const s=pr(e,l,this.g,u);if(this.p&&this.S)return s(this.S(u));for(a=this.L(this.h.slice(),this.u,this.A,this.B(this.v),l),o=1;o<this.numRounds;o+=1)this.F&&l%32!=0&&(a[a.length-1]&=16777215>>>24-l%32),a=this.L(a,l,0,this.K(this.o),l);return s(a)}setHMACKey(e,n,o){if(!this.k)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");const a=Vt(n,(o||{}).encoding||"UTF8",this.g);this.M(a(e))}M(e){const n=this.R>>>3,o=n/4-1;let a;if(this.numRounds!==1)throw new Error(tn);if(this.p)throw new Error("MAC key already set");for(n<e.binLen/8&&(e.value=this.L(e.value,e.binLen,0,this.K(this.o),this.T));e.value.length<=o;)e.value.push(0);for(a=0;a<=o;a+=1)this.m[a]=909522486^e.value[a],this.U[a]=1549556828^e.value[a];this.v=this.H(this.m,this.v),this.A=this.R,this.p=!0}getHMAC(e,n){const o=yr(n);return pr(e,this.T,this.g,o)(this.Y())}Y(){let e;if(!this.p)throw new Error("Cannot call getHMAC without first setting MAC key");const n=this.L(this.h.slice(),this.u,this.A,this.B(this.v),this.T);return e=this.H(this.U,this.K(this.o)),e=this.L(n,this.T,this.R,e,this.T),e}}class C{constructor(e,n){this.N=e,this.I=n}}function dr(t,e){let n;return e>32?(n=64-e,new C(t.I<<e|t.N>>>n,t.N<<e|t.I>>>n)):e!==0?(n=32-e,new C(t.N<<e|t.I>>>n,t.I<<e|t.N>>>n)):t}function Pe(t,e){return new C(t.N^e.N,t.I^e.I)}const $i=[new C(0,1),new C(0,32898),new C(2147483648,32906),new C(2147483648,2147516416),new C(0,32907),new C(0,2147483649),new C(2147483648,2147516545),new C(2147483648,32777),new C(0,138),new C(0,136),new C(0,2147516425),new C(0,2147483658),new C(0,2147516555),new C(2147483648,139),new C(2147483648,32905),new C(2147483648,32771),new C(2147483648,32770),new C(2147483648,128),new C(0,32778),new C(2147483648,2147483658),new C(2147483648,2147516545),new C(2147483648,32896),new C(0,2147483649),new C(2147483648,2147516424)],Mi=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function Ft(t){let e;const n=[];for(e=0;e<5;e+=1)n[e]=[new C(0,0),new C(0,0),new C(0,0),new C(0,0),new C(0,0)];return n}function Hi(t){let e;const n=[];for(e=0;e<5;e+=1)n[e]=t[e].slice();return n}function We(t,e){let n,o,a,l;const u=[],s=[];if(t!==null)for(o=0;o<t.length;o+=2)e[(o>>>1)%5][(o>>>1)/5|0]=Pe(e[(o>>>1)%5][(o>>>1)/5|0],new C(t[o+1],t[o]));for(n=0;n<24;n+=1){for(l=Ft(),o=0;o<5;o+=1)u[o]=(h=e[o][0],g=e[o][1],y=e[o][2],d=e[o][3],v=e[o][4],new C(h.N^g.N^y.N^d.N^v.N,h.I^g.I^y.I^d.I^v.I));for(o=0;o<5;o+=1)s[o]=Pe(u[(o+4)%5],dr(u[(o+1)%5],1));for(o=0;o<5;o+=1)for(a=0;a<5;a+=1)e[o][a]=Pe(e[o][a],s[o]);for(o=0;o<5;o+=1)for(a=0;a<5;a+=1)l[a][(2*o+3*a)%5]=dr(e[o][a],Mi[o][a]);for(o=0;o<5;o+=1)for(a=0;a<5;a+=1)e[o][a]=Pe(l[o][a],new C(~l[(o+1)%5][a].N&l[(o+2)%5][a].N,~l[(o+1)%5][a].I&l[(o+2)%5][a].I));e[0][0]=Pe(e[0][0],$i[n])}var h,g,y,d,v;return e}function rn(t){let e,n,o=0;const a=[0,0],l=[4294967295&t,t/en&2097151];for(e=6;e>=0;e--)n=l[e>>2]>>>8*e&255,n===0&&o===0||(a[o+1>>2]|=n<<8*(o+1),o+=1);return o=o!==0?o:1,a[0]|=o,{value:o+1>4?a:[a[0]],binLen:8+8*o}}function Et(t){return at(rn(t.binLen),t)}function gr(t,e){let n,o=rn(e);o=at(o,t);const a=e>>>2,l=(a-o.value.length%a)%a;for(n=0;n<l;n++)o.value.push(0);return o.value}class Vi extends Oi{constructor(e,n,o){let a=6,l=0;super(e,n,o);const u=o||{};if(this.numRounds!==1){if(u.kmacKey||u.hmacKey)throw new Error(tn);if(this.o==="CSHAKE128"||this.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.g=1,this.C=Vt(this.t,this.i,this.g),this.H=We,this.B=Hi,this.K=Ft,this.v=Ft(),this.F=!1,e){case"SHA3-224":this.R=l=1152,this.T=224,this.k=!0,this.S=this.Y;break;case"SHA3-256":this.R=l=1088,this.T=256,this.k=!0,this.S=this.Y;break;case"SHA3-384":this.R=l=832,this.T=384,this.k=!0,this.S=this.Y;break;case"SHA3-512":this.R=l=576,this.T=512,this.k=!0,this.S=this.Y;break;case"SHAKE128":a=31,this.R=l=1344,this.T=-1,this.F=!0,this.k=!1,this.S=null;break;case"SHAKE256":a=31,this.R=l=1088,this.T=-1,this.F=!0,this.k=!1,this.S=null;break;case"KMAC128":a=4,this.R=l=1344,this.X(o),this.T=-1,this.F=!0,this.k=!1,this.S=this._;break;case"KMAC256":a=4,this.R=l=1088,this.X(o),this.T=-1,this.F=!0,this.k=!1,this.S=this._;break;case"CSHAKE128":this.R=l=1344,a=this.O(o),this.T=-1,this.F=!0,this.k=!1,this.S=null;break;case"CSHAKE256":this.R=l=1088,a=this.O(o),this.T=-1,this.F=!0,this.k=!1,this.S=null;break;default:throw new Error("Chosen SHA variant is not supported")}this.L=function(s,h,g,y,d){return function(v,w,E,B,A,S,m){let x,L,K=0;const U=[],D=A>>>5,$=w>>>5;for(x=0;x<$&&w>=A;x+=D)B=We(v.slice(x,x+D),B),w-=A;for(v=v.slice(x),w%=A;v.length<D;)v.push(0);for(x=w>>>3,v[x>>2]^=S<<x%4*8,v[D-1]^=2147483648,B=We(v,B);32*U.length<m&&(L=B[K%5][K/5|0],U.push(L.I),!(32*U.length>=m));)U.push(L.N),K+=1,64*K%A==0&&(We(null,B),K=0);return U}(s,h,0,y,l,a,d)},u.hmacKey&&this.M(_e("hmacKey",u.hmacKey,this.g))}O(e,n){const o=function(l){const u=l||{};return{funcName:_e("funcName",u.funcName,1,{value:[],binLen:0}),customization:_e("Customization",u.customization,1,{value:[],binLen:0})}}(e||{});n&&(o.funcName=n);const a=at(Et(o.funcName),Et(o.customization));if(o.customization.binLen!==0||o.funcName.binLen!==0){const l=gr(a,this.R>>>3);for(let u=0;u<l.length;u+=this.R>>>5)this.v=this.H(l.slice(u,u+(this.R>>>5)),this.v),this.A+=this.R;return 4}return 31}X(e){const n=function(a){const l=a||{};return{kmacKey:_e("kmacKey",l.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:_e("Customization",l.customization,1,{value:[],binLen:0})}}(e||{});this.O(e,n.funcName);const o=gr(Et(n.kmacKey),this.R>>>3);for(let a=0;a<o.length;a+=this.R>>>5)this.v=this.H(o.slice(a,a+(this.R>>>5)),this.v),this.A+=this.R;this.p=!0}_(e){const n=at({value:this.h.slice(),binLen:this.u},function(o){let a,l,u=0;const s=[0,0],h=[4294967295&o,o/en&2097151];for(a=6;a>=0;a--)l=h[a>>2]>>>8*a&255,l===0&&u===0||(s[u>>2]|=l<<8*u,u+=1);return u=u!==0?u:1,s[u>>2]|=u<<8*u,{value:u+1>4?s:[s[0]],binLen:8+8*u}}(e.outputLen));return this.L(n.value,n.binLen,this.A,this.B(this.v),e.outputLen)}}class nn{async signDigest(e,n){const o=this.base64ToSha256(e),a=this.base64ToArray(o),l=this.base64ToArray(n),s=(await gi(a,l,{lowS:!0,extraEntropy:!1})).toCompactRawBytes();return this.arrayToBase64(s)}isValidSignDigest(e,n,o){const a=this.base64ToArray(e),l=fe.fromCompact(a),u=this.base64ToSha256(n),s=this.base64ToArray(u),h=this.base64ToArray(o);return wi(l,s,h)}encryptData(e,n){const{pass:o,iv:a}=this.#e(n);return this.#t(F.Buffer.from(e,"base64"),o,a,!1).toString("base64")}decryptData(e,n){const{pass:o,iv:a}=this.#e(n);return this.#t(F.Buffer.from(e,"base64"),o,a,!0).toString("base64")}generateKeypair(){const e=Ii.randomPrivateKey(),n=hi(e,!0);return{publicKey:this.arrayToBase64(n),privateKey:this.arrayToBase64(e)}}computeSharedSecret(e,n){const o=this.base64ToArray(e),a=this.base64ToArray(n),l=bi(o,a,!0);return this.arrayToBase64(l)}encryptWithSharedSecret(e,n,o){const a=this.computeSharedSecret(n,o);return this.encryptData(e,a)}shortcodeFromFullKey(e){const n=F.Buffer.from(e,"base64"),o=F.Buffer.from(new Uint8Array(n.buffer,32,33)).toString("base64"),a=this.base64Tohash(o),l=F.Buffer.from(a,"base64");return F.Buffer.from(new Uint8Array(l.buffer,0,3)).toString("hex")}combineKeypair(e,n){const o=new Uint8Array(65),a=this.base64ToArray(e),l=this.base64ToArray(n);return o.set(a,0),o.set(l,32),this.arrayToBase64(o)}splitKeypair(e){const n=this.base64ToArray(e),o=n.slice(0,32),a=n.slice(32),l=this.arrayToBase64(o),u=this.arrayToBase64(a);return{privateKey:l,publicKey:u}}#e(e){const n=F.Buffer.from(e,"base64"),o=n.slice(8,24),a=n.slice(0,8),l=n.slice(24,32),u=F.Buffer.alloc(8);for(let s=0;s<8;s++)u[s]=a[s]^l[s];return{pass:o,iv:u}}#t(e,n,o,a=!1){const l=fr.key(n);return fr.cfb(l,o,e,a)}base64Tohash(e){const n=new Vi("SHA3-256","B64");return n.update(e),n.getHash("B64")}base64ToSha256(e){const n=ur.parse(e);return Fi(n).toString(ur)}base64ToString(e){return F.Buffer.from(e,"base64").toString("utf-8")}base64ToArray(e){const n=F.Buffer.from(e,"base64");return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}arrayToBase64(e){return F.Buffer.from(e).toString("base64")}stringToBase64(e){return F.Buffer.from(e,"utf-8").toString("base64")}convertPublicKeyToHex(e){const n=this.base64ToArray(e);return F.Buffer.from(n).toString("hex")}convertPrivateKeyToHex(e){const n=this.base64ToArray(e);return F.Buffer.from(n).toString("hex")}}class ji{constructor(e){this.baseUrl=e,this.enigma=new nn}packUserStorage(e,n,o=[],a={}){const l=this.combineKeypair(n);return[[e,l],o,a]}generateUserKeypair(){return this.enigma.generateKeypair()}buildUserLink(e){const n=`/chat/${this.publicKeyToHex(e.publicKey)}`;return`${this.baseUrl}${n}`}async registerUser(e,n){try{return await this.#e({query:`
          mutation SignUp($name: String!, $keypair: InputKeyPair) {
            userSignUp(name: $name, keypair: $keypair) {
              name
              keys {
                private_key
                public_key
              }
            }
          }`,variables:{name:e,keypair:{publicKey:this.publicKeyToHex(n.publicKey),privateKey:this.privateKeyToHex(n.privateKey)}}})}catch{}}async sendMessage(e,n,o){const a=Math.floor(Date.now()/1e3);try{return await this.#e({query:`
          mutation ($keypair: InputKeyPair!, $peer: PublicKey!, $text: String!, $timestamp: Int!) {
            chatSendText(myKeypair: $keypair, peerPublicKey: $peer, text: $text, timestamp: $timestamp) {
              id
              index
            }
          }`,variables:{keypair:{publicKey:this.publicKeyToHex(e.publicKey),privateKey:this.privateKeyToHex(e.privateKey)},peer:n,text:o,timestamp:a}})}catch{}}async getMessages(e,n,o,a){try{return(await this.#e({query:`
          query ($keypair: InputKeyPair!, $peer: PublicKey!, $lastIndex: Int, $amount: Int!) {
            chatRead(myKeypair: $keypair, peerPublicKey: $peer, amount: $amount, before: $lastIndex) {
              id
              index
              timestamp
              author {
                publicKey
                name
              }
              content {
                __typename
                ... on FileContent {
                  url
                  type
                  sizeBytes
                  initialName
                }
                ... on TextContent {
                  text
                }
              }
            }
          }`,variables:{keypair:{publicKey:this.publicKeyToHex(e.publicKey),privateKey:this.privateKeyToHex(e.privateKey)},peer:n,amount:o,lastIndex:a}}))?.data?.chatRead}catch{}}async#e(e){const n=new Headers;n.append("Content-Type","application/json");const o={method:"POST",headers:n,body:JSON.stringify(e),redirect:"follow"};try{return await(await fetch(`${this.baseUrl}/naive_api`,o)).json()}catch(a){throw a}}combineKeypair(e){const n=this.enigma.base64ToArray(e.privateKey),o=this.enigma.base64ToArray(e.publicKey),a=new Uint8Array(n.length+o.length);return a.set(n,0),a.set(o,n.length),this.enigma.arrayToBase64(a)}publicKeyToHex(e){return this.enigma.convertPublicKeyToHex(e)}privateKeyToHex(e){return this.enigma.convertPrivateKeyToHex(e)}async getUploadKey(e,n,o){const a=Math.floor(Date.now()/1e3);try{return(await this.#e({query:`
               mutation GetUploadKey(
                  $myKeypair: InputKeyPair!
                  $destination: InputUploadDestination!
                  $entry: InputUploadEntry!
                  $timestamp: Int!
               ) {
                  uploadKey(
                     myKeypair: $myKeypair
                     destination: $destination
                     entry: $entry
                     timestamp: $timestamp
                  )
               }
            `,variables:{myKeypair:{publicKey:this.publicKeyToHex(e.publicKey),privateKey:this.privateKeyToHex(e.privateKey)},destination:n,entry:{clientName:o.name,clientType:o.type,clientSize:o.size,clientRelativePath:"/",clientLastModified:Math.floor(o.lastModified/1e3)},timestamp:a}}))?.data?.uploadKey}catch(l){throw l}}async uploadFileChunked(e,n,o){const l=Math.ceil(e.size/10485760),u=F.Buffer.from(n,"base64").toString("hex");for(let s=0;s<l;s++){const h=s*10485760,g=Math.min(h+10485760,e.size),y=e.slice(h,g),d=await fetch(`${this.baseUrl}/upload_chunk/${u}`,{method:"PUT",headers:{"Content-Range":`bytes ${h}-${g-1}/${e.size}`},body:y});if(!d.ok)throw new Error(`Chunk upload failed: ${d.status}`);o&&o((s+1)/l*100)}return n}async sendFile(e,n,o){const a=Math.floor(Date.now()/1e3);try{return(await this.#e({query:`
               mutation ChatSendFile(
                  $keypair: InputKeyPair!
                  $peer: PublicKey!
                  $uploadKey: FileKey!
                  $timestamp: Int!
               ) {
                  chatSendFile(
                     myKeypair: $keypair
                     peerPublicKey: $peer
                     uploadKey: $uploadKey
                     timestamp: $timestamp
                  ) {
                     id
                     index
                  }
               }
            `,variables:{keypair:{publicKey:this.publicKeyToHex(e.publicKey),privateKey:this.privateKeyToHex(e.privateKey)},peer:n,uploadKey:o,timestamp:a}}))?.data?.chatSendFile}catch(l){throw l}}async uploadMultipleFiles(e,n,o,a){const l=[],u=o.length,s={type:"DIALOG",keypair:{publicKey:n,privateKey:""}};for(let h=0;h<u;h++){const g=o[h],y=await this.getUploadKey(e,s,g);await this.uploadFileChunked(g,y,d=>{const v=(h+d/100)/u*100;a&&a(v,h+1,u,"uploading",g.name)}),l.push({uploadKey:y,fileName:g.name,fileType:g.type,fileSize:g.size})}for(let h=0;h<l.length;h++){const g=l[h],y=await this.sendFile(e,n,g.uploadKey);l[h].messageId=y.id,l[h].messageIndex=y.index}return l}}class Ge{static validateRecaptcha(){return!0}static validateCheckedDates(e){return["check-1","check-2","check-3","check-4"].some(o=>e[o]?.trim())}static validateFields(e){return["area","tariff","payment","language"].every(o=>{const a=e[o];return Array.isArray(a)?a.length>0:a?.trim()})}static collectCheckedDates(e){return["check-1","check-2","check-3","check-4"].filter(o=>e.get(o)).map(o=>e.get(o))}static extractFormData(e){const n={};return e.forEach((o,a)=>{a==="language"?(n[a]||(n[a]=[]),n[a].push(o)):n[a]=o}),n}}class wr{static saveDate(e,n){const o=JSON.stringify(n);localStorage.setItem(e,o)}static loadDate(e){const n=localStorage.getItem(e);return n?JSON.parse(n):null}}class zi{constructor(e,n,o,a,l){this.ecoTaxi=new ji(e),this.board=n,this.key=o,this.adminkey=a,this.encryptionManager=l,this.#e=null,this.#t="ecoTaxiFormData",this.init()}#e;#t;init(){const e=document.getElementById("form");e&&e.addEventListener("submit",this),window.onSubmit=this.handleEvent.bind(this)}handleEvent(e){e.preventDefault();const n=new FormData(e.target),o=Ge.extractFormData(n),a=Ge.collectCheckedDates(n),l=Ge.validateCheckedDates(o),u=Ge.validateFields(o);if(!l){this.showErrorMessage("Please provide at least one date in the check fields.");return}if(!u){this.showErrorMessage("Please fill in all required selects.");return}if(o.read!=="on"){this.showErrorMessage("Please accept the sorting guidelines.");return}this.sendFormData(o,a)}async sendFormData(e,n){const o=document.getElementById("sendBtn");try{o.disabled=!0;const a=await this.encryptionManager.hasVault();if(a||(this.#e=this.ecoTaxi.generateUserKeypair(),await this.ecoTaxi.registerUser(e.name,this.#e),e.chat=this.ecoTaxi.buildUserLink(this.#e),await this.ecoTaxi.sendMessage(this.#e,this.adminkey,this.generateText(e,n)),wr.saveDate(this.#t,{userName:e.name,userKeipair:{privateKey:this.#e.privateKey,publicKey:this.#e.publicKey},userData:e})),a&&!this.encryptionManager.isAuth&&(this.#e=this.ecoTaxi.generateUserKeypair(),await this.ecoTaxi.registerUser(e.name,this.#e),await this.ecoTaxi.sendMessage(this.#e,this.adminkey,this.generateText(e,n)),wr.saveDate(this.#t,{userName:e.name,userKeipair:{privateKey:this.#e.privateKey,publicKey:this.#e.publicKey},userData:e})),a&&this.encryptionManager.isAuth){const u=await this.encryptionManager.getData(),s=JSON.parse(u);if(s?.userData){["check-1","check-2","check-3","check-4","check-5"].forEach(y=>{delete s.userData[y]}),s.userData={...s.userData,...e},this.#e=s.userKeipair;const h={...e};await this.ecoTaxi.sendMessage(this.#e,this.adminkey,this.generateText(h,n));const g=JSON.stringify(s);await this.encryptionManager.setData(g)}else{this.#e=s.userKeipair,await this.ecoTaxi.registerUser(e.name,this.#e),e.chat=this.ecoTaxi.buildUserLink(this.#e);const h={...e};await this.ecoTaxi.sendMessage(this.#e,this.adminkey,this.generateText(h,n));const g=JSON.stringify({userData:e,userKeipair:this.#e,userName:e.name});await this.encryptionManager.setData(g)}}const l=document.querySelector('input[type="file"]');if(l&&l.files.length>0)try{await this.ecoTaxi.uploadMultipleFiles(this.#e,this.adminkey,l.files,(u,s,h,g,y)=>{})}catch(u){throw u}this.openModal()}catch{}finally{o.disabled=!1}}async sendMonday(e){return await fetch("https://api.monday.com/v2",{method:"post",headers:{"Content-Type":"application/json",Authorization:this.key},body:JSON.stringify({query:`
                       mutation ($myItemName: String!, $columnVals: JSON!) {
                           create_item (board_id: ${this.board}, item_name: $myItemName, column_values: $columnVals) {
                               id
                           }
                       }
                   `,variables:e})})}async uploadFileMonday(e,n){const o=new FormData;o.append("query",`
            mutation ($file: File!) {
                add_file_to_column (item_id: ${e}, column_id: "files", file: $file) {
                    id
                }
            }
        `),o.append("variables[file]",n);const l=await(await fetch("https://api.monday.com/v2/",{method:"POST",headers:{Authorization:this.key},body:o})).json()}generateText(e,n){const o={1:"Cash",2:"Transfer to account",3:"Invoice"};return[`Date: ${n.join(", ")}`,`Language: ${e.language.join(", ")||""}`,`Email: ${e.email||""}`,`Phone: ${e.phone||""}`,`Area: ${e.area||""}`,`Address: ${e.address||""}`,`Quantity: ${e.quantity||""}`,`Tariff: ${e.tariff||""}`,`Payment: ${o[e.payment]||""}`,e["check-5"]?"Saturday ready":"",`Promo Code: ${e.promoCode||""}`,`Comment: ${e.comment||""}`,`Location: ${e.link}`].filter(Boolean).join(`

`)}prepareRequestPayload(e,n){return{myItemName:e.name,columnVals:JSON.stringify({dup__of_name:e.address,email0:e.email,phone:{phone:e.phone.replace(/\s/g,""),countryShortName:e.countryCode},dropdown:e.area,dropdown0:e.language.join(", "),dup__of_language:e.tariff,dup__of_tariff:e.payment,text9:e.comment,text3:e.quantity,text0:n.join(", "),text05:e["check-5"]==="on"?"true":"",location0:e.link,_____:e.chat})}}showErrorMessage(e){const n=document.getElementById("error");n.innerText=e,n?.classList.remove("hidden"),setTimeout(()=>{n?.classList.add("hidden")},2500)}openModal(){const e=document.getElementById("modal"),n=document.querySelector("body");e?.classList.remove("hidden"),n?.classList.add("overflow-hidden")}}class le{static body=document.querySelector("body");static modalAuth=document.getElementById("modalAuth");static contentLogin=document.getElementById("contentLogin");static contentLogout=document.getElementById("contentLogout");static contentLoginPassword=document.getElementById("contentLoginPassword");static contentLogoutPassword=document.getElementById("contentLogoutPassword");static openModal(){this.modalAuth?.classList.remove("hidden"),this.body?.classList.add("overflow-hidden")}static closeModal(){this.modalAuth?.classList.add("hidden"),this.body?.classList.remove("overflow-hidden"),this.closeModalContentLogin(),this.closeModalContentLogout(),this.closeContentLoginPassword(),this.closeContentLogoutPassword()}static openModalContentLogin(){this.contentLogin?.classList.remove("hidden")}static openModalContentLogout(){this.contentLogout?.classList.remove("hidden")}static closeModalContentLogin(){this.contentLogin?.classList.add("hidden")}static closeModalContentLogout(){this.contentLogout?.classList.add("hidden")}static closeContentLoginPassword(){this.contentLoginPassword?.classList.add("hidden")}static closeContentLogoutPassword(){this.contentLogoutPassword?.classList.add("hidden")}}class mr{static enigma=new nn;static async saveEncryptedDataToFile(e,n){try{const{userName:o,userKeipair:a}=e,{privateKey:l,publicKey:u}=a,s=this.enigma.combineKeypair(l,u),g=JSON.stringify([[o,s],[],{}]),y=this.enigma.stringToBase64(g),d=this.enigma.stringToBase64(n),v=this.enigma.hash(d),w=this.enigma.encryptData(y,v),E=this.enigma.base64ToArray(w),B=new Blob([E],{type:"application/octet-stream"}),A=document.createElement("a");A.href=URL.createObjectURL(B),A.download="vault.data",A.click(),URL.revokeObjectURL(A.href)}catch{}}static async loadEncryptedDataFromFile(e,n){return new Promise((o,a)=>{const l=new FileReader;l.onload=async u=>{try{const s=new Uint8Array(u.target.result),h=this.enigma.arrayToBase64(s),g=this.enigma.stringToBase64(n),y=this.enigma.hash(g),d=this.enigma.decryptData(h,y),v=this.enigma.base64ToString(d),w=JSON.parse(v),E=w[0][0],B=w[0][1],{privateKey:A,publicKey:S}=this.enigma.splitKeypair(B);o({userName:E,userKeipair:{privateKey:A,publicKey:S}})}catch{a("Decryption error: incorrect password or corrupted data")}},l.onerror=()=>a("File reading error"),l.readAsArrayBuffer(e)})}}class qi{constructor(e){this.encryptionManager=e,this.init()}init(){const e=document.getElementById("modalAuth"),n=document.querySelector("#popupButtonLogin"),o=document.querySelector("#popupButtonLogout"),a=document.querySelector("#contentLogin"),l=document.querySelector("#contentLogout"),u=document.querySelector("#contentLoginPassword"),s=document.querySelector("#contentLogoutPassword"),h=document.querySelector("#downloadKeysButton"),g=document.querySelector("#logoutWithoutKeysButton"),y=document.querySelector("#encryptionPasswordInputLogin"),d=document.querySelector("#encryptionPasswordInputLogout"),v=document.querySelector("#confirmImportButton"),w=document.querySelector("#confirmImportButton input"),E=document.querySelector("#confirmDownloadButton"),B=document.querySelector("#importKeysButton"),A=document.querySelectorAll(".closeModalButton"),S=document.querySelector("#errorPassword");e?.addEventListener("click",m=>{m.target.classList.contains("modalContent")&&le.closeModal()}),n?.addEventListener("click",()=>{le.openModal(),le.openModalContentLogin()}),o?.addEventListener("click",()=>{le.openModal(),le.openModalContentLogout()}),A.forEach(m=>{m.addEventListener("click",()=>{le.closeModal()})}),B?.addEventListener("click",()=>{a?.classList.add("hidden"),u?.classList.remove("hidden")}),h?.addEventListener("click",()=>{l?.classList.add("hidden"),s?.classList.remove("hidden")}),g?.addEventListener("click",()=>{this.logoutWithoutKeys()}),y?.addEventListener("input",m=>{m.currentTarget.value.length>=12?(w.disabled=!1,v?.classList.remove("opacity-50","cursor-not-allowed"),v?.classList.add("cursor-pointer")):(w.disabled=!0,v?.classList.add("opacity-50","cursor-not-allowed"),v?.classList.remove("cursor-pointer"))}),d?.addEventListener("input",m=>{m.currentTarget.value.length>=12?E.disabled=!1:E.disabled=!0}),w?.addEventListener("change",async m=>{const x=m.target.files[0],L=y.value;try{const K=await mr.loadEncryptedDataFromFile(x,L);this.encryptionManager.setData(JSON.stringify(K)),le.closeModal()}catch{S.textContent="Incorrect password",S?.classList.remove("hidden"),setTimeout(()=>{S?.classList.add("hidden")},2500)}}),E?.addEventListener("click",async()=>{try{const m=await this.encryptionManager.getData(),x=JSON.parse(m);await mr.saveEncryptedDataToFile({userName:x.userName,userKeipair:x.userKeipair},d?.value),le.closeModal(),this.encryptionManager.clearVault()}catch{}}),this.encryptionManager.addEventListener("authChange",m=>{const{isAuth:x}=m.detail;x?(n?.classList.remove("flex"),n?.classList.add("hidden"),o?.classList.remove("hidden"),o?.classList.add("flex")):(n?.classList.add("flex"),n?.classList.remove("hidden"),o?.classList.add("hidden"),o?.classList.remove("flex"))})}async logoutWithoutKeys(){await this.encryptionManager.clearVault(),le.closeModal()}}const on=new ue;new qi(on);new zi(Ye.BASE_URL,Ye.BOARD,Ye.MAIN_KEY,Ye.ADMIN_KEY,on);
